<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Internal API | Reactant.jl</title>
    <meta name="description" content="Documentation for Reactant.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/Reactant.jl/previews/PR1910/assets/style.D4Pj99bC.css" as="style">
    <link rel="preload stylesheet" href="/Reactant.jl/previews/PR1910/vp-icons.css" as="style">
    
    <script type="module" src="/Reactant.jl/previews/PR1910/assets/app.DJCpGARD.js"></script>
    <link rel="preload" href="/Reactant.jl/previews/PR1910/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Reactant.jl/previews/PR1910/assets/chunks/theme.BR1npxAX.js">
    <link rel="modulepreload" href="/Reactant.jl/previews/PR1910/assets/chunks/framework.BJNPFkoY.js">
    <link rel="modulepreload" href="/Reactant.jl/previews/PR1910/assets/api_internal.md._wqoyST0.lean.js">
    <link rel="icon" href="/Reactant.jl/previews/PR1910/favicon.ico">
    <script src="/versions.js"></script>
    <script src="/Reactant.jl/previews/PR1910/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Reactant.jl/previews/PR1910/" data-v-0f4f798b><!--[--><!--]--><!--[--><!--[--><!--[--><img class="VPImage dark logo" src="/Reactant.jl/previews/PR1910/logo.svg" alt data-v-35a7d0b8><!--]--><!--[--><img class="VPImage light logo" src="/Reactant.jl/previews/PR1910/logo.svg" alt data-v-35a7d0b8><!--]--><!--]--><!--]--><span data-v-0f4f798b>Reactant.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Reactant.jl/previews/PR1910/" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Home</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Getting Started</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/introduction" data-v-acbfed09><!--[--><span data-v-acbfed09>Introduction</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/introduction/configuration" data-v-acbfed09><!--[--><span data-v-acbfed09>Configuration</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/introduction/FAQs" data-v-acbfed09><!--[--><span data-v-acbfed09>FAQs</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://enzymead.github.io/Reactant.jl/benchmarks/" target="_blank" rel="noreferrer" tabindex="0" data-v-e6d46098 data-v-956ec74c><!--[--><span data-v-956ec74c>Benchmarks</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Tutorials</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/partial-evaluation" data-v-acbfed09><!--[--><span data-v-acbfed09>Partial Evaluation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/control-flow" data-v-acbfed09><!--[--><span data-v-acbfed09>Control Flow</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/automatic-differentiation" data-v-acbfed09><!--[--><span data-v-acbfed09>Automatic Differentiation</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/sharding" data-v-acbfed09><!--[--><span data-v-acbfed09>Sharding</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/profiling" data-v-acbfed09><!--[--><span data-v-acbfed09>Profiling</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/multihost" data-v-acbfed09><!--[--><span data-v-acbfed09>Multi-Host Environments</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/local-build" data-v-acbfed09><!--[--><span data-v-acbfed09>Local build</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/tutorials/persistent_compile_cache" data-v-acbfed09><!--[--><span data-v-acbfed09>Persistent Compilation Cache</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>API</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/api" data-v-acbfed09><!--[--><span data-v-acbfed09>Core Reactant API</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/sharding" data-v-acbfed09><!--[--><span data-v-acbfed09>Sharding</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/serialization" data-v-acbfed09><!--[--><span data-v-acbfed09>Serialization</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/ops" data-v-acbfed09><!--[--><span data-v-acbfed09>Ops</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/config" data-v-acbfed09><!--[--><span data-v-acbfed09>Configuration</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>MLIR Dialects</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/arith" data-v-acbfed09><!--[--><span data-v-acbfed09>ArithOps</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/affine" data-v-acbfed09><!--[--><span data-v-acbfed09>Affine</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/builtin" data-v-acbfed09><!--[--><span data-v-acbfed09>Builtin</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/chlo" data-v-acbfed09><!--[--><span data-v-acbfed09>Chlo</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/enzyme" data-v-acbfed09><!--[--><span data-v-acbfed09>Enzyme</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/enzymexla" data-v-acbfed09><!--[--><span data-v-acbfed09>EnzymeXLA</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/func" data-v-acbfed09><!--[--><span data-v-acbfed09>Func</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/gpu" data-v-acbfed09><!--[--><span data-v-acbfed09>GPU</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/llvm" data-v-acbfed09><!--[--><span data-v-acbfed09>LLVM</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/mpi" data-v-acbfed09><!--[--><span data-v-acbfed09>MPI</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/memref" data-v-acbfed09><!--[--><span data-v-acbfed09>MemRef</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/mosaicgpu" data-v-acbfed09><!--[--><span data-v-acbfed09>Mosaic GPU</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/nvvm" data-v-acbfed09><!--[--><span data-v-acbfed09>NVVM</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/shardy" data-v-acbfed09><!--[--><span data-v-acbfed09>Shardy</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/sparsetensor" data-v-acbfed09><!--[--><span data-v-acbfed09>SparseTensor</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/stablehlo" data-v-acbfed09><!--[--><span data-v-acbfed09>StableHLO</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/triton" data-v-acbfed09><!--[--><span data-v-acbfed09>Triton</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/tritonext" data-v-acbfed09><!--[--><span data-v-acbfed09>TritonExt</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/tpu" data-v-acbfed09><!--[--><span data-v-acbfed09>TPU</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/dialects/vhlo" data-v-acbfed09><!--[--><span data-v-acbfed09>VHLO</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-7dd3104a data-v-48c802d0><p class="title" data-v-48c802d0>Low-Level API</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/mlirc" data-v-acbfed09><!--[--><span data-v-acbfed09>MLIR API</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-acbfed09><a class="VPLink link" href="/Reactant.jl/previews/PR1910/api/xla" data-v-acbfed09><!--[--><span data-v-acbfed09>XLA</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link active" href="/Reactant.jl/previews/PR1910/api/internal" data-v-acbfed09><!--[--><span data-v-acbfed09>Internal API</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://julialang.org/slack/" aria-label="slack" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-slack"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><!--[--><a target="_blank" data-decoration="★" title="255 GitHub stars" href="https://github.com/EnzymeAD/Reactant.jl" data-v-b4d08338><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor" style="vertical-align:middle;margin-right:0.25rem;margin-left:0.5rem;" data-v-b4d08338><path d="M12 .297C5.375.297 0 5.673 0 12.3c0 5.292 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577 0-.285-.01-1.04-.015-2.04-3.338.727-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.807 1.305 3.493.997.107-.774.42-1.305.762-1.605-2.665-.3-5.467-1.333-5.467-5.931 0-1.31.47-2.382 1.236-3.222-.123-.303-.535-1.52.117-3.166 0 0 1.01-.323 3.31 1.23.96-.267 1.98-.4 3-.405 1.02.005 2.04.138 3 .405 2.3-1.553 3.31-1.23 3.31-1.23.653 1.646.24 2.863.117 3.166.765.84 1.236 1.912 1.236 3.222 0 4.61-2.807 5.625-5.477 5.921.43.372.823 1.102.823 2.222 0 1.606-.015 2.902-.015 3.293 0 .32.192.693.8.577C20.565 22.1 24 17.588 24 12.297 24 5.673 18.627.297 12 .297z" data-v-b4d08338></path></svg><span data-v-b4d08338>0.3k</span></a><a class="mobile" target="_blank" title="255 GitHub stars" href="https://github.com/EnzymeAD/Reactant.jl" data-v-b4d08338><svg xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 21 21" fill="none" data-v-b4d08338><path d="M19.625 5.60534C18.7083 4.03477 17.4649 2.79135 15.8945 1.87479C14.3238 0.958185 12.6091 0.5 10.7492 0.5C8.88947 0.5 7.17422 0.958325 5.60388 1.87479C4.0333 2.7913 2.78997 4.03477 1.87332 5.60534C0.956814 7.17587 0.498535 8.89089 0.498535 10.7504C0.498535 12.984 1.15021 14.9926 2.4539 16.7766C3.75744 18.5607 5.44142 19.7952 7.50571 20.4803C7.746 20.5249 7.92388 20.4936 8.03954 20.387C8.15524 20.2804 8.21302 20.1467 8.21302 19.9868C8.21302 19.9601 8.21073 19.7199 8.20629 19.266C8.20171 18.8122 8.19956 18.4162 8.19956 18.0783L7.89256 18.1315C7.69682 18.1673 7.44989 18.1825 7.15178 18.1782C6.8538 18.174 6.54446 18.1428 6.22419 18.0847C5.90377 18.0272 5.60575 17.8937 5.32988 17.6846C5.05416 17.4755 4.85842 17.2018 4.74272 16.8639L4.60925 16.5568C4.52029 16.3523 4.38023 16.1251 4.18888 15.8761C3.99754 15.6269 3.80405 15.458 3.60831 15.369L3.51486 15.3021C3.45259 15.2577 3.39481 15.204 3.34138 15.1418C3.28799 15.0796 3.24802 15.0173 3.22132 14.955C3.19458 14.8926 3.21674 14.8414 3.28804 14.8012C3.35933 14.761 3.48817 14.7416 3.67512 14.7416L3.94196 14.7814C4.11993 14.8171 4.34007 14.9236 4.60266 15.1017C4.86511 15.2796 5.08085 15.5109 5.24994 15.7956C5.4547 16.1605 5.7014 16.4385 5.99072 16.6299C6.27982 16.8212 6.5713 16.9167 6.86488 16.9167C7.15846 16.9167 7.41203 16.8945 7.62567 16.8502C7.83908 16.8057 8.0393 16.7388 8.22625 16.6499C8.30633 16.0535 8.52437 15.5953 8.88017 15.275C8.37304 15.2217 7.9171 15.1414 7.51212 15.0347C7.10736 14.9278 6.6891 14.7544 6.25761 14.5139C5.82589 14.2738 5.46774 13.9756 5.18309 13.6198C4.89839 13.2639 4.66474 12.7966 4.48247 12.2183C4.3001 11.6399 4.20889 10.9726 4.20889 10.2163C4.20889 9.13941 4.56044 8.22304 5.26341 7.46665C4.93411 6.65705 4.96519 5.74947 5.35676 4.744C5.61482 4.66382 5.9975 4.72399 6.50463 4.92412C7.01186 5.12434 7.38323 5.29587 7.61912 5.43808C7.85502 5.58024 8.04402 5.70071 8.18642 5.79842C9.01411 5.56715 9.86825 5.45149 10.7491 5.45149C11.6299 5.45149 12.4843 5.56715 13.312 5.79842L13.8192 5.47823C14.166 5.26459 14.5756 5.06881 15.0469 4.89083C15.5185 4.71295 15.8791 4.66396 16.1284 4.74414C16.5286 5.74966 16.5643 6.65719 16.2349 7.46679C16.9378 8.22318 17.2895 9.13978 17.2895 10.2164C17.2895 10.9727 17.198 11.6421 17.0159 12.225C16.8336 12.808 16.5979 13.2749 16.3088 13.6265C16.0194 13.9781 15.659 14.274 15.2275 14.5141C14.7959 14.7544 14.3775 14.9278 13.9728 15.0347C13.5678 15.1415 13.1119 15.2219 12.6047 15.2752C13.0673 15.6755 13.2986 16.3073 13.2986 17.1704V19.9864C13.2986 20.1464 13.3542 20.2799 13.4656 20.3867C13.5768 20.4932 13.7524 20.5246 13.9927 20.4799C16.0573 19.7949 17.7413 18.5603 19.0448 16.7762C20.3481 14.9922 21 12.9837 21 10.75C20.9996 8.89075 20.541 7.17587 19.625 5.60534Z" fill="currentColor" data-v-b4d08338></path></svg></a><!--]--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>API Reference</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/api" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Reactant API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/sharding" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Sharding</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/serialization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Serialization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/ops" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Ops</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/config" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Configuration</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>MLIR Dialects</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/arith" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>ArithOps</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/affine" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Affine</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/builtin" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Builtin</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/chlo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Chlo</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/enzyme" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Enzyme</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/enzymexla" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>EnzymeXLA</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/func" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Func</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/gpu" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>GPU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/llvm" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>LLVM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/mpi" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MPI</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/memref" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MemRef</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/mosaicgpu" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Mosaic GPU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/nvvm" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>NVVM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/shardy" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Shardy</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/sparsetensor" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SparseTensor</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/stablehlo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>StableHLO</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/triton" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Triton</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/tritonext" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>TritonExt</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/tpu" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>TPU</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/dialects/vhlo" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>VHLO</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h3 class="text" data-v-a4b0d9bf>Low-Level API</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/mlirc" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>MLIR API</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/xla" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>XLA</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Reactant.jl/previews/PR1910/api/internal" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Internal API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--[--><!--[--><!--[--><!--[--><br><h2> Trusted by </h2><a class="enjoyer" href="https://lux.csail.mit.edu/" target="_blank"><img width="32" height="32" src="https://raw.githubusercontent.com/LuxDL/Lux.jl/refs/heads/main/assets/lux-logo.svg"><span><p class="extra-info">Scientific Computing</p><p class="heading">Lux.jl</p><p class="extra-info">Machine Learning</p></span></a><a class="enjoyer" href="https://bsc-quantic.github.io/Tenet.jl/stable/" target="_blank"><img width="32" height="32" src="https://raw.githubusercontent.com/bsc-quantic/Tenet.jl/refs/heads/master/docs/src/assets/logo.svg"><span><p class="extra-info">Quantum Simulation</p><p class="heading">Tenet.jl</p><p class="extra-info">Tensor Networks</p></span></a><!--]--><!--]--><!--]--><!--]--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Reactant_jl_previews_PR1910_api_internal" data-v-83890dd9><div><h1 id="Internal-API" tabindex="-1">Internal API <a class="header-anchor" href="#Internal-API" aria-label="Permalink to &quot;Internal API {#Internal-API}&quot;">​</a></h1><div class="danger custom-block"><p class="custom-block-title">Private</p><p>These functions are not part of the public API and are subject to change at any time.</p></div><details class="jldocstring custom-block"><summary><a id="Reactant.REDUB_ARGUMENTS_NAME" href="#Reactant.REDUB_ARGUMENTS_NAME"><span class="jlbinding">Reactant.REDUB_ARGUMENTS_NAME</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">REDUB_ARGUMENTS_NAME</span></span></code></pre></div><p>The variable name bound to <code>call_with_reactant</code>&#39;s tuple of arguments in its <code>@generated</code> method definition.</p><p>This binding can be used to manually reference/destructure <code>call_with_reactants</code> arguments</p><p>This is required because user arguments could have a name which clashes with whatever name we choose for our argument. Thus we gensym to create it.</p><p>This originates from <a href="https://github.com/JuliaLabs/Cassette.jl/blob/c29b237c1ec0deda3a1037ec519eebe216952bfe/src/overdub.jl#L154" target="_blank" rel="noreferrer">https://github.com/JuliaLabs/Cassette.jl/blob/c29b237c1ec0deda3a1037ec519eebe216952bfe/src/overdub.jl#L154</a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Reactant.jl/blob/100864fd750564df1a00e0f7177d1ca3a6b5f3eb/src/utils.jl#L35-L47" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="Reactant.Compiler.codegen_unflatten!" href="#Reactant.Compiler.codegen_unflatten!"><span class="jlbinding">Reactant.Compiler.codegen_unflatten!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">codegen_unflatten!</span></span></code></pre></div><p>Generate Julia code to wrap the XLA buffers back into the output result datatypes. The name is due to its similarity to the <code>unflatten</code> function in <code>jax.tree_util.register_pytree_node</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Reactant.jl/blob/100864fd750564df1a00e0f7177d1ca3a6b5f3eb/src/Compiler.jl#L3011-L3016" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="Reactant.Compiler.codegen_flatten!" href="#Reactant.Compiler.codegen_flatten!"><span class="jlbinding">Reactant.Compiler.codegen_flatten!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">codegen_flatten!</span></span></code></pre></div><p>Generate Julia code to extract the XLA buffers from input arguments. The name is due to its similarity to the <code>flatten</code> function in <code>jax.tree_util.register_pytree_node</code>.</p><p><strong>Arguments</strong></p><ul><li><code>linear_args</code>: A list of arguments to be flattened.</li></ul><p><strong>Returns</strong></p><ul><li><p><code>flatten_names</code>: A list of <code>Symbol</code>s representing the names of the flattened arguments.</p></li><li><p><code>flatten_code</code>: A list of <code>Expr</code>s to extract the XLA buffers from the input arguments.</p></li></ul><p><strong>Note</strong></p><p>The <em>linearized arguments</em> do not directly refer to the are the arguments that have been flattened into a single list.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Reactant.jl/blob/100864fd750564df1a00e0f7177d1ca3a6b5f3eb/src/Compiler.jl#L2698-L2716" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="Reactant.Compiler.codegen_xla_call" href="#Reactant.Compiler.codegen_xla_call"><span class="jlbinding">Reactant.Compiler.codegen_xla_call</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">codegen_xla_call</span></span></code></pre></div><p>Generate Julia code to call the XLA executable.</p><p><strong>Arguments</strong></p><ul><li><p><code>flatten_names</code>: A list of <code>Symbol</code>s representing the names of the flattened linear arguments.</p></li><li><p><code>nresults</code>: The number of results to expect.</p></li><li><p><code>is_pure</code>: Whether the function being compiled is pure (i.e., has no side effects)</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Reactant.jl/blob/100864fd750564df1a00e0f7177d1ca3a6b5f3eb/src/Compiler.jl#L3275-L3285" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="Reactant.synchronize" href="#Reactant.synchronize"><span class="jlbinding">Reactant.synchronize</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">synchronize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{ConcretePJRTArray,ConcretePJRTNumber}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">synchronize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{ConcreteIFRTArray,ConcreteIFRTNumber}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Blocks until the computation is complete. Returns <code>nothing</code>. Does nothing if the input is not supported by Reactant. For tuples, synchronizes each element of the tuple.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>This function is internal and is not part of the public API. Prefer <code>@compile</code> with <code>sync=true</code> to compile functions that block until the computation is complete instead of calling this function.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Reactant.jl/blob/100864fd750564df1a00e0f7177d1ca3a6b5f3eb/src/ConcreteRArray.jl#L152-L163" target="_blank" rel="noreferrer">source</a><!--]--></span></details><h2 id="Other-Docstrings" tabindex="-1">Other Docstrings <a class="header-anchor" href="#Other-Docstrings" aria-label="Permalink to &quot;Other Docstrings {#Other-Docstrings}&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">Private</p><p>These docstrings are present here to prevent missing docstring warnings. For official Enzyme documentation checkout <a href="https://enzymead.github.io/Enzyme.jl/stable/" target="_blank" rel="noreferrer">https://enzymead.github.io/Enzyme.jl/stable/</a>.</p></div><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Forward" href="#EnzymeCore.Forward"><span class="jlbinding">EnzymeCore.Forward</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Forward</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ForwardMode"><code>ForwardMode</code></a> that doesn&#39;t return the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L512-L516" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ForwardWithPrimal" href="#EnzymeCore.ForwardWithPrimal"><span class="jlbinding">EnzymeCore.ForwardWithPrimal</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ForwardWithPrimal</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ForwardMode"><code>ForwardMode</code></a> that also returns the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L519-L523" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Reverse" href="#EnzymeCore.Reverse"><span class="jlbinding">EnzymeCore.Reverse</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Reverse</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> that doesn&#39;t return the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L326-L330" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseHolomorphic" href="#EnzymeCore.ReverseHolomorphic"><span class="jlbinding">EnzymeCore.ReverseHolomorphic</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseHolomorphic</span></span></code></pre></div><p>Holomorphic instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> that doesn&#39;t return the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L340-L344" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseHolomorphicWithPrimal" href="#EnzymeCore.ReverseHolomorphicWithPrimal"><span class="jlbinding">EnzymeCore.ReverseHolomorphicWithPrimal</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseHolomorphicWithPrimal</span></span></code></pre></div><p>Holomorphic instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> that also returns the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L347-L351" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseSplitNoPrimal" href="#EnzymeCore.ReverseSplitNoPrimal"><span class="jlbinding">EnzymeCore.ReverseSplitNoPrimal</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseSplitNoPrimal</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> that doesn&#39;t return the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L431-L435" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseSplitWithPrimal" href="#EnzymeCore.ReverseSplitWithPrimal"><span class="jlbinding">EnzymeCore.ReverseSplitWithPrimal</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseSplitWithPrimal</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> that also returns the primal</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L438-L442" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseWithPrimal" href="#EnzymeCore.ReverseWithPrimal"><span class="jlbinding">EnzymeCore.ReverseWithPrimal</span></a> <span class="VPBadge info jlObjectType jlConstant"><!--[-->Constant<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseWithPrimal</span></span></code></pre></div><p>Default instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> that also returns the primal.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L333-L337" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ABI" href="#EnzymeCore.ABI"><span class="jlbinding">EnzymeCore.ABI</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">abstract type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ABI</span></span></code></pre></div><p>Abstract type for what ABI will be used.</p><p><strong>Subtypes</strong></p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.FFIABI"><code>FFIABI</code></a> (the default)</p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.InlineABI"><code>InlineABI</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.NonGenABI"><code>NonGenABI</code></a></p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L209-L219" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Active" href="#EnzymeCore.Active"><span class="jlbinding">EnzymeCore.Active</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p>Mark a function argument <code>x</code> of <a href="./@ref Enzyme.autodiff"><code>autodiff</code></a> as active, Enzyme will auto-differentiate in respect <code>Active</code> arguments.</p><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Enzyme gradients with respect to integer values are zero. <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Active"><code>Active</code></a> will automatically convert plain integers to floating point values, but cannot do so for integer values in tuples and structs.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L36-L47" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Annotation" href="#EnzymeCore.Annotation"><span class="jlbinding">EnzymeCore.Annotation</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">abstract type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Annotation{T}</span></span></code></pre></div><p>Abstract type for <a href="./@ref Enzyme.autodiff"><code>autodiff</code></a> function argument wrappers like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Const"><code>Const</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Active"><code>Active</code></a> and <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>Duplicated</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L14-L19" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.BatchDuplicated" href="#EnzymeCore.BatchDuplicated"><span class="jlbinding">EnzymeCore.BatchDuplicated</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchDuplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂xs)</span></span></code></pre></div><p>Like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>Duplicated</code></a>, except contains several shadows to compute derivatives for all at once. Argument <code>∂f_∂xs</code> should be a tuple of the several values of type <code>x</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L126-L131" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.BatchDuplicatedNoNeed" href="#EnzymeCore.BatchDuplicatedNoNeed"><span class="jlbinding">EnzymeCore.BatchDuplicatedNoNeed</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchDuplicatedNoNeed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂xs)</span></span></code></pre></div><p>Like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.DuplicatedNoNeed"><code>DuplicatedNoNeed</code></a>, except contains several shadows to compute derivatives for all at once. Argument <code>∂f_∂xs</code> should be a tuple of the several values of type <code>x</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L154-L159" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.BatchMixedDuplicated" href="#EnzymeCore.BatchMixedDuplicated"><span class="jlbinding">EnzymeCore.BatchMixedDuplicated</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BatchMixedDuplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂xs)</span></span></code></pre></div><p>Like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.MixedDuplicated"><code>MixedDuplicated</code></a>, except contains several shadows to compute derivatives for all at once. Only used within custom rules.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L195-L200" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Const" href="#EnzymeCore.Const"><span class="jlbinding">EnzymeCore.Const</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p>Mark a function argument <code>x</code> of <a href="./@ref Enzyme.autodiff"><code>autodiff</code></a> as constant, Enzyme will not auto-differentiate in respect <code>Const</code> arguments.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L23-L28" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Duplicated" href="#EnzymeCore.Duplicated"><span class="jlbinding">EnzymeCore.Duplicated</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Duplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂x)</span></span></code></pre></div><p>Mark a function argument <code>x</code> of <a href="./@ref Enzyme.autodiff"><code>autodiff</code></a> as duplicated, Enzyme will auto-differentiate in respect to such arguments, with <code>dx</code> acting as an accumulator for gradients (so <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.231ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2754 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(566,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1116,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mi" transform="translate(1616,0)"><path data-c="1D715" d="M202 508Q179 508 169 520T158 547Q158 557 164 577T185 624T230 675T301 710L333 715H345Q378 715 384 714Q447 703 489 661T549 568T566 457Q566 362 519 240T402 53Q321 -22 223 -22Q123 -22 73 56Q42 102 42 148V159Q42 276 129 370T322 465Q383 465 414 434T455 367L458 378Q478 461 478 515Q478 603 437 639T344 676Q266 676 223 612Q264 606 264 572Q264 547 246 528T202 508ZM430 306Q430 372 401 400T333 428Q270 428 222 382Q197 354 183 323T150 221Q132 149 132 116Q132 21 232 21Q244 21 250 22Q327 35 374 112Q389 137 409 196T430 306Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2182,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>∂</mi><mi>f</mi><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>∂</mi><mi>x</mi></math></mjx-assistive-mml></mjx-container> will be <em>added to</em>) <code>∂f_∂x</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L57-L64" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.DuplicatedNoNeed" href="#EnzymeCore.DuplicatedNoNeed"><span class="jlbinding">EnzymeCore.DuplicatedNoNeed</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DuplicatedNoNeed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂x)</span></span></code></pre></div><p>Like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>Duplicated</code></a>, except also specifies that Enzyme may avoid computing the original result and only compute the derivative values. This creates opportunities for improved performance.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> square_byref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(out, v)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    out[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    nothing</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">out </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Enzyme</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">autodiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Reverse, square_byref, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DuplicatedNoNeed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(out, dout), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dout[]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># output</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span></span></code></pre></div><p>For example, marking the out variable as <code>DuplicatedNoNeed</code> instead of <code>Duplicated</code> allows Enzyme to avoid computing <code>v * v</code> (while still computing its derivative).</p><p>This should only be used if <code>x</code> is a write-only variable. Otherwise, if the differentiated function stores values in <code>x</code> and reads them back in subsequent computations, using <code>DuplicatedNoNeed</code> may result in incorrect derivatives. In particular, <code>DuplicatedNoNeed</code> should not be used for preallocated workspace, even if the user might not care about its final value, as marking a variable as NoNeed means that reads from the variable are now undefined.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L79-L111" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.FFIABI" href="#EnzymeCore.FFIABI"><span class="jlbinding">EnzymeCore.FFIABI</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FFIABI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ABI</span></span></code></pre></div><p>Foreign function call <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ABI"><code>ABI</code></a>. JIT the differentiated function, then inttoptr call the address.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L222-L226" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ForwardMode" href="#EnzymeCore.ForwardMode"><span class="jlbinding">EnzymeCore.ForwardMode</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ForwardMode{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ReturnPrimal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ABI,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ErrIfFuncWritten,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    RuntimeActivity,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    StrongZero</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Mode{ABI,ErrIfFuncWritten,RuntimeActivity,StrongZero}</span></span></code></pre></div><p>Subtype of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Mode"><code>Mode</code></a> for forward mode differentiation.</p><p><strong>Type parameters</strong></p><ul><li><p><code>ReturnPrimal</code>: whether to return the primal return value from the augmented-forward.</p></li><li><p>other parameters: see <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Mode"><code>Mode</code></a></p></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The type parameters of <code>ForwardMode</code> are not part of the public API and can change without notice. Please use one of the following concrete instantiations instead:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Forward"><code>Forward</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ForwardWithPrimal"><code>ForwardWithPrimal</code></a></p></li></ul><p>You can modify them with the following helper functions:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>WithPrimal</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>NoPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_err_if_func_written"><code>set_err_if_func_written</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_err_if_func_written"><code>clear_err_if_func_written</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_runtime_activity"><code>set_runtime_activity</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_runtime_activity"><code>clear_runtime_activity</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_abi"><code>set_abi</code></a></p></li></ul></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L482-L508" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.InlineABI" href="#EnzymeCore.InlineABI"><span class="jlbinding">EnzymeCore.InlineABI</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> InlineABI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ABI</span></span></code></pre></div><p>Inlining function call <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ABI"><code>ABI</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L229-L233" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.MixedDuplicated" href="#EnzymeCore.MixedDuplicated"><span class="jlbinding">EnzymeCore.MixedDuplicated</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MixedDuplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, ∂f_∂x)</span></span></code></pre></div><p>Like <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>Duplicated</code></a>, except x may contain both active [immutable] and duplicated [mutable] data which is differentiable. Only used within custom rules.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L183-L188" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Mode" href="#EnzymeCore.Mode"><span class="jlbinding">EnzymeCore.Mode</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">abstract type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Mode{ABI,ErrIfFuncWritten,RuntimeActivity,StrongZero}</span></span></code></pre></div><p>Abstract type for which differentiation mode will be used.</p><p><strong>Subtypes</strong></p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ForwardMode"><code>ForwardMode</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a></p></li></ul><p><strong>Type parameters</strong></p><ul><li><p><code>ABI</code>: what runtime <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ABI"><code>ABI</code></a> to use</p></li><li><p><code>ErrIfFuncWritten</code>: whether to error when the function differentiated is a closure and written to.</p></li><li><p><code>RuntimeActivity</code>: whether to enable runtime activity (default off). Runtime Activity is required is the differentiability of all mutable variables cannot be determined statically. For a deeper explanation see the <a href="./@ref faq-runtime-activity">FAQ</a></p></li><li><p><code>StrongZero</code>: whether to enforce that propagating a zero derivative input always ends up in zero derivative outputs. This is required to avoid nan&#39;s if one of the arguments may be infinite or nan. For a deeper explanation see the <a href="./@ref faq-strong-zero">FAQ</a></p></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The type parameters of <code>Mode</code> are not part of the public API and can change without notice. You can modify them with the following helper functions:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>WithPrimal</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>NoPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_err_if_func_written"><code>set_err_if_func_written</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_err_if_func_written"><code>clear_err_if_func_written</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_runtime_activity"><code>set_runtime_activity</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_runtime_activity"><code>clear_runtime_activity</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_strong_zero"><code>set_strong_zero</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_strong_zero"><code>clear_strong_zero</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_abi"><code>set_abi</code></a></p></li></ul></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L245-L271" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.NonGenABI" href="#EnzymeCore.NonGenABI"><span class="jlbinding">EnzymeCore.NonGenABI</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NonGenABI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ABI</span></span></code></pre></div><p>Non-generated function <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ABI"><code>ABI</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L236-L240" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseMode" href="#EnzymeCore.ReverseMode"><span class="jlbinding">EnzymeCore.ReverseMode</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseMode{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ReturnPrimal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    RuntimeActivity,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    StrongZero,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ABI,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Holomorphic,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ErrIfFuncWritten</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Mode{ABI,ErrIfFuncWritten,RuntimeActivity,StrongZero}</span></span></code></pre></div><p>Subtype of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Mode"><code>Mode</code></a> for reverse mode differentiation.</p><p><strong>Type parameters</strong></p><ul><li><p><code>ReturnPrimal</code>: whether to return the primal return value from the augmented-forward pass.</p></li><li><p><code>Holomorphic</code>: Whether the complex result function is holomorphic and we should compute <code>d/dz</code></p></li><li><p>other parameters: see <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Mode"><code>Mode</code></a></p></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The type parameters of <code>ReverseMode</code> are not part of the public API and can change without notice. Please use one of the following concrete instantiations instead:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Reverse"><code>Reverse</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseWithPrimal"><code>ReverseWithPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseHolomorphic"><code>ReverseHolomorphic</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseHolomorphicWithPrimal"><code>ReverseHolomorphicWithPrimal</code></a></p></li></ul><p>You can modify them with the following helper functions:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>WithPrimal</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>NoPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_err_if_func_written"><code>set_err_if_func_written</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_err_if_func_written"><code>clear_err_if_func_written</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_runtime_activity"><code>set_runtime_activity</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_runtime_activity"><code>clear_runtime_activity</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_strong_zero"><code>set_strong_zero</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_strong_zero"><code>clear_strong_zero</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_abi"><code>set_abi</code></a></p></li></ul></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L292-L323" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseModeSplit" href="#EnzymeCore.ReverseModeSplit"><span class="jlbinding">EnzymeCore.ReverseModeSplit</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReverseModeSplit{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ReturnPrimal,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ReturnShadow,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Width,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    RuntimeActivity,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    StrongZero,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ModifiedBetween,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ABI,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ErrFuncIfWritten</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Mode{ABI,ErrIfFuncWritten,RuntimeActivity,StrongZero}</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    WithPrimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Enzyme.Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Subtype of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Mode"><code>Mode</code></a> for split reverse mode differentiation, to use in <a href="./@ref"><code>autodiff_thunk</code></a> and variants.</p><p><strong>Type parameters</strong></p><ul><li><p><code>ReturnShadow</code>: whether to return the shadow return value from the augmented-forward.</p></li><li><p><code>Width</code>: batch size (pick <code>0</code> to derive it automatically)</p></li><li><p><code>ModifiedBetween</code>: <code>Tuple</code> of each argument&#39;s &quot;modified between&quot; state (pick <code>true</code> to derive it automatically).</p></li><li><p>other parameters: see <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a></p></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The type parameters of <code>ReverseModeSplit</code> are not part of the public API and can change without notice. Please use one of the following concrete instantiations instead:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseSplitNoPrimal"><code>ReverseSplitNoPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseSplitWithPrimal"><code>ReverseSplitWithPrimal</code></a></p></li></ul><p>You can modify them with the following helper functions:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>WithPrimal</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><code>NoPrimal</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_err_if_func_written"><code>set_err_if_func_written</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_err_if_func_written"><code>clear_err_if_func_written</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_runtime_activity"><code>set_runtime_activity</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_runtime_activity"><code>clear_runtime_activity</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_strong_zero"><code>set_strong_zero</code></a> / <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.clear_strong_zero"><code>clear_strong_zero</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.set_abi"><code>set_abi</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseSplitModified-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{MBO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{MB}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><code>ReverseSplitModified</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseSplitWidth-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{WidthO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, WidthO, MB, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{Width}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, WidthO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><code>ReverseSplitWidth</code></a></p></li></ul></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L394-L428" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Combined-Union{Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}" href="#EnzymeCore.Combined-Union{Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><span class="jlbinding">EnzymeCore.Combined</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Combined</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Turn a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> object into a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> object while preserving as many of the settings as possible.</p><p>This function acts as the identity on a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a>.</p><p>See also <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Split-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}, Val{ShadowInit}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><code>Split</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L753-L761" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}" href="#EnzymeCore.NoPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><span class="jlbinding">EnzymeCore.NoPrimal</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NoPrimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode which excludes the primal value.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L378-L382" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseSplitModified-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{MBO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{MB}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}" href="#EnzymeCore.ReverseSplitModified-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{MBO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{MB}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, MBO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><span class="jlbinding">EnzymeCore.ReverseSplitModified</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseSplitModified</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseModeSplit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{MB}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> mode where <code>ModifiedBetween</code> is set to <code>MB</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L445-L449" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ReverseSplitWidth-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{WidthO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, WidthO, MB, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{Width}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, WidthO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}" href="#EnzymeCore.ReverseSplitWidth-Union{Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{WidthO}, Tuple{MB}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, WidthO, MB, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}, Val{Width}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, MB, WidthO, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><span class="jlbinding">EnzymeCore.ReverseSplitWidth</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseSplitWidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseModeSplit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{W}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new instance of <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> mode where <code>Width</code> is set to <code>W</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L452-L456" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.Split-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}, Val{ShadowInit}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}" href="#EnzymeCore.Split-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}}, Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}, Val{ReturnShadow}, Val{Width}, Val{ModifiedBetween}, Val{ShadowInit}}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><span class="jlbinding">EnzymeCore.Split</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReverseMode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{ReturnShadow}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{Width}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{ModifiedBetween}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{ShadowInit}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Turn a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseMode"><code>ReverseMode</code></a> object into a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a> object while preserving as many of the settings as possible. The rest of the settings can be configured with optional positional arguments of <code>Val</code> type.</p><p>This function acts as the identity on a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ReverseModeSplit"><code>ReverseModeSplit</code></a>.</p><p>See also <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Combined-Union{Tuple{EnzymeCore.ReverseModeSplit{ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}}, Tuple{ShadowInit}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{ModifiedBetween}, Tuple{Width}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnShadow}, Tuple{ReturnPrimal}} where {ReturnPrimal, ReturnShadow, RuntimeActivity, StrongZero, Width, ModifiedBetween, ABI, Holomorphic, ErrIfFuncWritten, ShadowInit}"><code>Combined</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L699-L710" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}" href="#EnzymeCore.WithPrimal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}}, Tuple{ErrIfFuncWritten}, Tuple{Holomorphic}, Tuple{ABI}, Tuple{StrongZero}, Tuple{RuntimeActivity}, Tuple{ReturnPrimal}} where {ReturnPrimal, RuntimeActivity, StrongZero, ABI, Holomorphic, ErrIfFuncWritten}"><span class="jlbinding">EnzymeCore.WithPrimal</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">WithPrimal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode which includes the primal value.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L371-L375" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.clear_err_if_func_written" href="#EnzymeCore.clear_err_if_func_written"><span class="jlbinding">EnzymeCore.clear_err_if_func_written</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">clear_err_if_func_written</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode which doesn&#39;t throw an error for attempts to write into an unannotated function object.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L651-L655" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.clear_runtime_activity" href="#EnzymeCore.clear_runtime_activity"><span class="jlbinding">EnzymeCore.clear_runtime_activity</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">clear_runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode where runtime activity analysis is deactivated. See <a href="./@ref">Enzyme.Mode</a> for more information on runtime activity.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L668-L672" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.clear_strong_zero" href="#EnzymeCore.clear_strong_zero"><span class="jlbinding">EnzymeCore.clear_strong_zero</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">clear_strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode where strong_zero is deactivated. See <a href="./@ref">Enzyme.Mode</a> for more information on strong zero.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L685-L689" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.compiler_job_from_backend" href="#EnzymeCore.compiler_job_from_backend"><span class="jlbinding">EnzymeCore.compiler_job_from_backend</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compiler_job_from_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">KernelAbstractions.Backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, TT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GPUCompiler.CompilerJob</span></span></code></pre></div><p>Returns a GPUCompiler CompilerJob from a backend as specified by the first argument to the function.</p><p>For example, in CUDA one would do:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EnzymeCore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">compiler_job_from_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CUDABackend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@nospecialize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@nospecialize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(TT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mi </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GPUCompiler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">methodinstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(F, TT)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> GPUCompiler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CompilerJob</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mi, CUDA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">compiler_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CUDA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">device</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L592-L605" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.ignore_derivatives-Tuple{T} where T" href="#EnzymeCore.ignore_derivatives-Tuple{T} where T"><span class="jlbinding">EnzymeCore.ignore_derivatives</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ignore_derivatives</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span></span></code></pre></div><p>Behaves like the <code>identity</code> function, but disconnects the &quot;shadow&quot; associated with <code>x</code>. This has the effect of preventing any derivatives from being propagated through <code>x</code>.</p><div class="tip custom-block"><p class="custom-block-title">Enzyme 0.13.74</p><p>Support for <code>ignore_derivatives</code> was added in Enzyme 0.13.74.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L623-L632" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.make_zero" href="#EnzymeCore.make_zero"><span class="jlbinding">EnzymeCore.make_zero</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, seen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, prev</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val{copy_if_inactive}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span></span></code></pre></div><p>Recursively make a zero&#39;d copy of the value <code>prev</code> of type <code>T</code>. The argument <code>copy_if_inactive</code> specifies what to do if the type <code>T</code> is guaranteed to be inactive, use the primal (the default) or still copy the value.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L553-L558" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.make_zero!" href="#EnzymeCore.make_zero!"><span class="jlbinding">EnzymeCore.make_zero!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make_zero!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(val</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, seen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdSet{Any}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Nothing</span></span></code></pre></div><p>Recursively set a variables differentiable fields to zero.</p><div class="tip custom-block"><p class="custom-block-title">Warn</p><p>Only applicable for mutable types <code>T</code>.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L561-L568" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.make_zero-Union{Tuple{copy_if_inactive}, Tuple{T}, Tuple{T, Val{copy_if_inactive}}} where {T, copy_if_inactive}" href="#EnzymeCore.make_zero-Union{Tuple{copy_if_inactive}, Tuple{T}, Tuple{T, Val{copy_if_inactive}}} where {T, copy_if_inactive}"><span class="jlbinding">EnzymeCore.make_zero</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">make_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prev</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Helper function to recursively make zero.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L581-L585" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal" href="#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><span class="jlbinding">EnzymeCore.needs_primal</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{Mode}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns <code>true</code> if the mode needs the primal value, otherwise <code>false</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L385-L390" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.remake_zero!" href="#EnzymeCore.remake_zero!"><span class="jlbinding">EnzymeCore.remake_zero!</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">remake_zero!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(val</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, seen</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdSet{Any}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IdSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Nothing</span></span></code></pre></div><p>Recursively set a variables differentiable fields to zero.</p><div class="tip custom-block"><p class="custom-block-title">Warn</p><p>This assumes that the input value was previously generated by make_zero. Otherwise, this may not zero the immutable fields of a struct.</p></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L571-L578" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.runtime_activity-Union{Tuple{EnzymeCore.Mode{&lt;:Any, &lt;:Any, RuntimeActivity}}, Tuple{RuntimeActivity}} where RuntimeActivity" href="#EnzymeCore.runtime_activity-Union{Tuple{EnzymeCore.Mode{&lt;:Any, &lt;:Any, RuntimeActivity}}, Tuple{RuntimeActivity}} where RuntimeActivity"><span class="jlbinding">EnzymeCore.runtime_activity</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Mode}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns whether the given mode has runtime activity set. For a deeper explanation of what strong zero is see the <a href="./@ref faq-runtime-activity">FAQ</a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L274-L279" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.set_abi" href="#EnzymeCore.set_abi"><span class="jlbinding">EnzymeCore.set_abi</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_abi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{ABI}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode with its <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.ABI"><code>ABI</code></a> set to the chosen type.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L692-L696" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.set_err_if_func_written" href="#EnzymeCore.set_err_if_func_written"><span class="jlbinding">EnzymeCore.set_err_if_func_written</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_err_if_func_written</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode which throws an error for any attempt to write into an unannotated function object.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L644-L648" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.set_runtime_activity" href="#EnzymeCore.set_runtime_activity"><span class="jlbinding">EnzymeCore.set_runtime_activity</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, activity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{FwdConfig,RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_runtime_activity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, prev</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode where runtime activity analysis is activated / set to the desired value. See the <a href="./@ref faq-runtime-activity">FAQ</a> for more information.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L658-L665" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.set_strong_zero" href="#EnzymeCore.set_strong_zero"><span class="jlbinding">EnzymeCore.set_strong_zero</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, activity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{FwdConfig,RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set_strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, prev</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return a new mode where strong zero is activated / set to the desired value. See the <a href="./@ref faq-strong-zero">FAQ</a> for more information.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L675-L682" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.strong_zero-Union{Tuple{EnzymeCore.Mode{&lt;:Any, &lt;:Any, &lt;:Any, StrongZero}}, Tuple{StrongZero}} where StrongZero" href="#EnzymeCore.strong_zero-Union{Tuple{EnzymeCore.Mode{&lt;:Any, &lt;:Any, &lt;:Any, StrongZero}}, Tuple{StrongZero}} where StrongZero"><span class="jlbinding">EnzymeCore.strong_zero</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Mode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">strong_zero</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Mode}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns whether the given mode has strong zero set. For a deeper explanation of what strong zero is see the <a href="./@ref faq-strong-zero">FAQ</a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L283-L288" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.within_autodiff-Tuple{}" href="#EnzymeCore.within_autodiff-Tuple{}"><span class="jlbinding">EnzymeCore.within_autodiff</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">within_autodiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>Returns true if within autodiff, otherwise false.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/EnzymeCore.jl#L614-L618" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.AugmentedReturn" href="#EnzymeCore.EnzymeRules.AugmentedReturn"><span class="jlbinding">EnzymeCore.EnzymeRules.AugmentedReturn</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AugmentedReturn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(primal, shadow, tape)</span></span></code></pre></div><p>Augment the primal return value of a function with its shadow, as well as any additional information needed to correctly compute the reverse pass, stored in <code>tape</code>.</p><p>Unless specified by the config that a variable is not overwritten, rules must assume any arrays/data structures/etc are overwritten between the forward and the reverse pass. Any floats or variables passed by value are always preserved as is (as are the arrays themselves, just not necessarily the values in the array).</p><p>See also <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.augmented_primal"><code>augmented_primal</code></a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L203-L214" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.FwdConfig" href="#EnzymeCore.EnzymeRules.FwdConfig"><span class="jlbinding">EnzymeCore.EnzymeRules.FwdConfig</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FwdConfig{NeedsPrimal, NeedsShadow, Width, RuntimeActivity, StrongZero}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FwdConfigWidth{Width} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> FwdConfig{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Width}</span></span></code></pre></div><p>Configuration type to dispatch on in custom forward rules (see <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.forward"><code>forward</code></a>.</p><ul><li><p><code>NeedsPrimal</code> and <code>NeedsShadow</code>: boolean values specifying whether the primal and shadow (resp.) should be returned.</p></li><li><p><code>Width</code>: an integer that specifies the number of adjoints/shadows simultaneously being propagated.</p></li><li><p><code>RuntimeActivity</code>: whether runtime activity is enabled. See the <a href="./@ref faq-runtime-activity">FAQ</a> for more information.</p></li><li><p><code>StrongZero</code>: whether strong zero is enabled. See the <a href="./@ref faq-strong-zero">FAQ</a> for more information.</p></li></ul><p>Getters for the type parameters are provided by <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><code>needs_primal</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow"><code>needs_shadow</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a>, <code>runtime_activity</code>, and <code>strong_zero</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L33-L45" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.RevConfig" href="#EnzymeCore.EnzymeRules.RevConfig"><span class="jlbinding">EnzymeCore.EnzymeRules.RevConfig</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RevConfig{NeedsPrimal, NeedsShadow, Width, Overwritten, RuntimeActivity, StrongZero}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">RevConfigWidth{Width} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RevConfig{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Width}</span></span></code></pre></div><p>Configuration type to dispatch on in custom reverse rules (see <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.augmented_primal"><code>augmented_primal</code></a> and <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.reverse"><code>reverse</code></a>).</p><ul><li><p><code>NeedsPrimal</code> and <code>NeedsShadow</code>: boolean values specifying whether the primal and shadow (resp.) should be returned.</p></li><li><p><code>Width</code>: an integer that specifies the number of adjoints/shadows simultaneously being propagated.</p></li><li><p><code>Overwritten</code>: a tuple of booleans of whether each argument (including the function itself) is modified between the forward and reverse pass (<code>true</code> if potentially modified between).</p></li><li><p><code>RuntimeActivity</code>: whether runtime activity is enabled. See the <a href="./@ref faq-runtime-activity">FAQ</a> for more information.</p></li><li><p><code>StrongZero</code>: whether strong zero is enabled. See the <a href="./@ref faq-strong-zero">FAQ</a> for more information.</p></li></ul><p>Getters for the type parameters are provided by <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><code>needs_primal</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow"><code>needs_shadow</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a>, <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.overwritten-Union{Tuple{EnzymeCore.EnzymeRules.RevConfigWidth{&lt;:Any, var&quot;#s7&quot;, var&quot;#s3&quot;, Overwritten} where {var&quot;#s7&quot;, var&quot;#s3&quot;}}, Tuple{Overwritten}} where Overwritten"><code>overwritten</code></a>, <code>runtime_activity</code>, and <code>strong_zero</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L87-L101" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules._constrain_and_name-Tuple{Expr}" href="#EnzymeCore.EnzymeRules._constrain_and_name-Tuple{Expr}"><span class="jlbinding">EnzymeCore.EnzymeRules._constrain_and_name</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_constrain_and_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, _)</span></span></code></pre></div><p>Internal function.</p><p>Turn both <code>a</code> and <code>::constraint</code> into <code>a::Annotation{&lt;:constraint}</code> etc</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L60-L66" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules._just_name-Tuple{Expr}" href="#EnzymeCore.EnzymeRules._just_name-Tuple{Expr}"><span class="jlbinding">EnzymeCore.EnzymeRules._just_name</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_just_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(arg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Expr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, _)</span></span></code></pre></div><p>Internal function.</p><p>Extract <code>a</code> from <code>a::constraint</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L77-L83" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules._normalize_scalarrules_macro_input-Tuple{Any, Any, Any}" href="#EnzymeCore.EnzymeRules._normalize_scalarrules_macro_input-Tuple{Any, Any, Any}"><span class="jlbinding">EnzymeCore.EnzymeRules._normalize_scalarrules_macro_input</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_normalize_scalarrules_macro_input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(call, maybe_setup, partials)</span></span></code></pre></div><p>Internal function.</p><p>returns (in order) the correctly escaped:</p><ul><li><p><code>call</code> with out any type constraints</p></li><li><p><code>setup_stmts</code>: the content of <code>@setup</code> or <code>[]</code> if that is not provided,</p></li><li><p><code>inputs</code>: with all args having the constraints removed from call, or defaulting to <code>Number</code></p></li><li><p><code>partials</code>: which are all <code>Expr{:tuple,...}</code></p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L111-L122" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules._unconstrain-Tuple{Symbol}" href="#EnzymeCore.EnzymeRules._unconstrain-Tuple{Symbol}"><span class="jlbinding">EnzymeCore.EnzymeRules._unconstrain</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_unconstrain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a)</span></span></code></pre></div><p>Internal function.</p><p>Turn both <code>a</code> and <code>a::S</code> into <code>a</code></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L45-L51" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.augmented_primal" href="#EnzymeCore.EnzymeRules.augmented_primal"><span class="jlbinding">EnzymeCore.EnzymeRules.augmented_primal</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">augmented_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation{typeof(f)}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Code to run during the original forward pass through the code. Any additional data can be saved from forward to reverse pass. This may be required as arguments might be overwritten before the reverse pass is run.</p><p>This should compute and mutate the same values as the original function (if requested).</p><p>It should also return a shadow data structure to hold derivatives (if requested).</p><p>Must return an <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.AugmentedReturn"><code>AugmentedReturn</code></a> type.</p><ul><li><p>The primal must be the same type of the original return if <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><code>needs_primal(config)</code></a>, otherwise nothing.</p></li><li><p>The shadow must be nothing if <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow"><code>needs_shadow(config)</code></a> is <code>false</code>. If width is 1, the shadow should be the same type of the original return. If the width is greater than 1, the shadow should be <code>NTuple{original return, width}</code>.</p></li><li><p>The tape can be any type (including <code>Nothing</code>), and is preserved for the reverse call.</p></li></ul><p>See <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.augmented_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.RevConfig}, Type{&lt;:Annotation}}"><code>augmented_rule_return_type</code></a> for more information.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L243-L262" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.augmented_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.RevConfig}, Type{&lt;:Annotation}}" href="#EnzymeCore.EnzymeRules.augmented_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.RevConfig}, Type{&lt;:Annotation}}"><span class="jlbinding">EnzymeCore.EnzymeRules.augmented_rule_return_type</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">augmented_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(C</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, cache</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">augmented_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, CacheType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">augmented_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(C</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">augmented_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the expected result type of a custom augmented forward pass rule, given the configuration <code>C</code> return activity and type <code>RT</code>, and cache <code>cache</code>. Alternatively, this can be called with the configuration type, return activity, and cache type.</p><p>Consider <code>RealRt</code> as the original return type of the rule, accessible as <code>eltype(RT)</code>. The return type can be computed as follows:</p><p>We must return a struct of type <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.AugmentedReturn"><code>AugmentedReturn</code></a>, which has three elements (and corresponding type parameter).</p><p>The first element is the primal type, which is the original result (of type <code>RealRt</code>) if requested by the config (<a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><code>needs_primal</code></a>), otherwise nothing.</p><p>The second element is the shadow type, if requested by the config (<a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow"><code>needs_shadow</code></a>, otherwise nothing. If requested, the shadow is of type: If the <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a> is one, the shadow is the same type as the primal (<code>RealRt</code>). If the <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a> is not one, the shadow is a tuple containing <code>width</code> of the original return types (<code>NTuple{width,RealRt}</code>).</p><p>The third element is user defined, whatever type the cache is you want to save from forward to reverse pass. In this case, it will be determined by <code>cache</code>, or <code>CacheType</code>.</p><p>If a cache type is not provided a unionall will be returned</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L276-L300" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.forward" href="#EnzymeCore.EnzymeRules.forward"><span class="jlbinding">EnzymeCore.EnzymeRules.forward</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forward</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(fwdconfig, func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation{typeof(f)}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Calculate the forward derivative. The first argument is a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.FwdConfig"><code>FwdConfig</code></a> object describing parameters of the differentiation. The second argument <code>func</code> is the callable to which the rule applies, either wrapped in a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Const"><code>Const</code></a>), or a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>Duplicated</code></a> if it is a closure. The third argument is the return type annotation, and all other arguments are the annotated arguments to the function <code>f</code>.</p><p>Valid types for <code>RT</code> are:</p><ul><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>EnzymeCore.Duplicated</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.DuplicatedNoNeed"><code>EnzymeCore.DuplicatedNoNeed</code></a></p></li><li><p><a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Const"><code>EnzymeCore.Const</code></a></p></li></ul><p>The return from this function must be a type matching <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.forward_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.FwdConfig}, Type{&lt;:Annotation}}"><code>forward_rule_return_type</code></a> when given the <code>fwdconfig</code> and <code>RT</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L14-L30" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.forward_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.FwdConfig}, Type{&lt;:Annotation}}" href="#EnzymeCore.EnzymeRules.forward_rule_return_type-Tuple{Type{&lt;:EnzymeCore.EnzymeRules.FwdConfig}, Type{&lt;:Annotation}}"><span class="jlbinding">EnzymeCore.EnzymeRules.forward_rule_return_type</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forward_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(C</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">forward_rule_return_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the expected result type of a custom forward rule, given the configuration <code>C</code> and return activity and type <code>RT</code>.</p><p>Consider <code>RealRt</code> as the original return type of the rule, accessible as <code>eltype(RT)</code>. The return type can be computed as follows:</p><p>If the shadow isn&#39;t needed, return the original result (of type <code>RealRt</code>) if requested by the config (<a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.ReverseMode{ReturnPrimal}}, Tuple{ReturnPrimal}} where ReturnPrimal"><code>needs_primal</code></a>), otherwise nothing.</p><p>Otherwise, first construct a shadow return. If the <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a> is one, the shadow is the same type as the primal (<code>RealRt</code>). If the <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><code>width</code></a> is not one, the shadow is a tuple containing <code>width</code> of the original return types (<code>NTuple{width,RealRt}</code>).</p><p>Finally, if both the primal and shadow are requested, return a <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.Duplicated"><code>EnzymeCore.Duplicated</code></a> or <a href="/Reactant.jl/previews/PR1910/api/internal#EnzymeCore.BatchDuplicated"><code>EnzymeCore.BatchDuplicated</code></a> of primal and shadows. Otherwise, just return the shadows.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L153-L170" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.inactive" href="#EnzymeCore.EnzymeRules.inactive"><span class="jlbinding">EnzymeCore.EnzymeRules.inactive</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inactive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f), args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular function as always being inactive in both its return result and the function call itself.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L426-L430" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.inactive_arg" href="#EnzymeCore.EnzymeRules.inactive_arg"><span class="jlbinding">EnzymeCore.EnzymeRules.inactive_arg</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inactive_arg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f), args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular function as always having inactive non-keyword arguments. The return type must be a tuple of Val&#39;s whose value is the argument marked inactive.</p><p>This function is currently considered internal/experimental and may not respect semver.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L471-L478" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.inactive_kwarg" href="#EnzymeCore.EnzymeRules.inactive_kwarg"><span class="jlbinding">EnzymeCore.EnzymeRules.inactive_kwarg</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inactive_kwarg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f), args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular function as always having inactive keyword arguments. The return does not matter, merely its declaration.</p><p>This function is currently considered internal/experimental and may not respect semver.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L455-L461" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.inactive_noinl" href="#EnzymeCore.EnzymeRules.inactive_noinl"><span class="jlbinding">EnzymeCore.EnzymeRules.inactive_noinl</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inactive_noinl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f), args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular function as always being inactive in both its return result and the function call itself, but do not prevent inlining of the function.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L440-L445" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.inactive_type-Tuple{Type}" href="#EnzymeCore.EnzymeRules.inactive_type-Tuple{Type}"><span class="jlbinding">EnzymeCore.EnzymeRules.inactive_type</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inactive_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{Ty}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular type <code>Ty</code> as always being inactive.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L503-L507" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.multiply_fwd_into" href="#EnzymeCore.EnzymeRules.multiply_fwd_into"><span class="jlbinding">EnzymeCore.EnzymeRules.multiply_fwd_into</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">multiply_fwd_into</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prev, partial, dx)</span></span></code></pre></div><p>Internal function.</p><p>Multiply a partial derivative (df/dx) by its shadow input (dx) to form <code>df</code>.</p><p>Specifically, perform prev + partial * dx, returning the result or re-using prev&#39;s memory, where applicable.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L89-L97" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.multiply_rev_into" href="#EnzymeCore.EnzymeRules.multiply_rev_into"><span class="jlbinding">EnzymeCore.EnzymeRules.multiply_rev_into</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">multiply_rev_into</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(prev, partial, df)</span></span></code></pre></div><p>Internal function.</p><p>Multiply a partial derivative (df/dx) by its shadow input (df) to form <code>dx</code>.</p><p>Specifically, perform prev + conj(partial * conj(dx)), returning the result or re-using prev&#39;s memory, where applicable.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L100-L108" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow" href="#EnzymeCore.EnzymeRules.needs_shadow-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, var&quot;#s9&quot;, NeedsShadow} where {var&quot;#s9&quot;, Width}}, Tuple{NeedsShadow}} where NeedsShadow"><span class="jlbinding">EnzymeCore.EnzymeRules.needs_shadow</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_shadow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_shadow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_shadow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_shadow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Whether a custom rule should return the shadow (derivative) of the function result.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L60-L67" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.noalias" href="#EnzymeCore.EnzymeRules.noalias"><span class="jlbinding">EnzymeCore.EnzymeRules.noalias</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">noalias</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">typeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f), args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Mark a particular function as always being a fresh allocation which does not alias any other accessible memory.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L488-L493" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.overwritten-Union{Tuple{EnzymeCore.EnzymeRules.RevConfigWidth{&lt;:Any, var&quot;#s7&quot;, var&quot;#s3&quot;, Overwritten} where {var&quot;#s7&quot;, var&quot;#s3&quot;}}, Tuple{Overwritten}} where Overwritten" href="#EnzymeCore.EnzymeRules.overwritten-Union{Tuple{EnzymeCore.EnzymeRules.RevConfigWidth{&lt;:Any, var&quot;#s7&quot;, var&quot;#s3&quot;, Overwritten} where {var&quot;#s7&quot;, var&quot;#s3&quot;}}, Tuple{Overwritten}} where Overwritten"><span class="jlbinding">EnzymeCore.EnzymeRules.overwritten</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">overwritten</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">overwritten</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A tuple of booleans for each argument (including the function itself), indicating if it is modified between the forward and reverse pass (<code>true</code> if potentially modified between).</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L112-L119" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.primal_type-Union{Tuple{RT}, Tuple{EnzymeCore.EnzymeRules.FwdConfig, Type{&lt;:Annotation{RT}}}} where RT" href="#EnzymeCore.EnzymeRules.primal_type-Union{Tuple{RT}, Tuple{EnzymeCore.EnzymeRules.FwdConfig, Type{&lt;:Annotation{RT}}}} where RT"><span class="jlbinding">EnzymeCore.EnzymeRules.primal_type</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">primal_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">primal_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">primal_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">primal_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the expected primal return type given a reverse mode config and return activity</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L126-L133" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.reverse" href="#EnzymeCore.EnzymeRules.reverse"><span class="jlbinding">EnzymeCore.EnzymeRules.reverse</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation{typeof(f)}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dret</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Active</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tape, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">reverse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation{typeof(f)}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), tape, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Annotation...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Takes gradient of derivative, activity annotation, and tape. If there is an active return, <code>dret</code> is passed as <code>Active{T}</code> with the derivative of the active return value. Otherwise, <code>dret</code> is passed as <code>Type{Duplicated{T}}</code>, etc.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L265-L272" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.shadow_type-Union{Tuple{RT}, Tuple{EnzymeCore.EnzymeRules.FwdConfig, Type{&lt;:Annotation{RT}}}} where RT" href="#EnzymeCore.EnzymeRules.shadow_type-Union{Tuple{RT}, Tuple{EnzymeCore.EnzymeRules.FwdConfig, Type{&lt;:Annotation{RT}}}} where RT"><span class="jlbinding">EnzymeCore.EnzymeRules.shadow_type</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shadow_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shadow_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shadow_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shadow_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:Annotation{RT}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the expected shadow return type given a reverse mode config and return activity</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L139-L146" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.uses_symbol-Tuple{Any, Symbol}" href="#EnzymeCore.EnzymeRules.uses_symbol-Tuple{Any, Symbol}"><span class="jlbinding">EnzymeCore.EnzymeRules.uses_symbol</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">uses_symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a, b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Internal function.</p><p>Checks if <code>a</code> contains a use of the symbol <code>b</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L20-L26" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width" href="#EnzymeCore.EnzymeRules.width-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width}}, Tuple{Width}} where Width"><span class="jlbinding">EnzymeCore.EnzymeRules.width</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Get the size of a batch.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L72-L79" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, NeedsPrimal, NeedsShadow} where {NeedsShadow, Width}}, Tuple{NeedsPrimal}} where NeedsPrimal" href="#EnzymeCore.needs_primal-Union{Tuple{EnzymeCore.EnzymeRules.FwdConfigWidth{Width, NeedsPrimal, NeedsShadow} where {NeedsShadow, Width}}, Tuple{NeedsPrimal}} where NeedsPrimal"><span class="jlbinding">EnzymeCore.needs_primal</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FwdConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RevConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:FwdConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">needs_primal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Type{&lt;:RevConfig}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Whether a custom rule should return the original result of the function.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/rules.jl#L49-L56" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block"><summary><a id="EnzymeCore.EnzymeRules.@easy_rule-Tuple{Any, Any, Vararg{Any}}" href="#EnzymeCore.EnzymeRules.@easy_rule-Tuple{Any, Any, Vararg{Any}}"><span class="jlbinding">EnzymeCore.EnzymeRules.@easy_rule</span></a> <span class="VPBadge info jlObjectType jlMacro"><!--[-->Macro<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@easy_rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x₁</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x₂</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">             @setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(statement₁, statement₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₁_∂x₁, ∂f₁_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₂_∂x₁, ∂f₂_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">             ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>A convenience macro that generates simple forward and reverse Enzyme rules using the provided partial derivatives.</p><p>The <code>easy_rule</code> macro assumes that the function <code>f</code> does not mutate any of its arguments, does not read from global data, and no output aliases with any other output nor input.</p><p>The <code>easy_rule</code> macro only works if inputs are scalars or arrays of scalars, and the result is a scalar, array, or tuple thereof.</p><p>For each output result (a single output is assumed if a scalar is returned), a tuple of partial derivatives is expected. Specifically, each tuple contains one entry for each argument to <code>f</code>. This entry should contain the jacobian <code>∂fi_∂xj</code> where <code>i</code> is the number of the output, and <code>j</code> is the number of the input. If both input <code>i</code> and output <code>j</code> are scalars, <code>∂fi_∂xj</code> should be a scalar. If at least one of these are an abstractarray, <code>∂fi_∂xj</code> should be a tensor of size <code>(size(output[j])..., size(input[i])...)</code>, where scalars are considered zero-dimensional.</p><p>The arguments to <code>f</code> can either have no type constraints, or specific type constraints.</p><p>The result of <code>f(x₁, x₂, ...)</code> is automatically bound to <code>Ω</code>. This allows the primal result to be referenced (as <code>Ω</code>) within the derivative/setup expressions.</p><p>At present this does not support defining for closures/functors.</p><p>The <code>@setup</code> argument can be elided if no setup code is need. In other words:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@easy_rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x₁, x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₁_∂x₁, ∂f₁_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₂_∂x₁, ∂f₂_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">             ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>is equivalent to:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@easy_rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x₁, x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">             @setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₁_∂x₁, ∂f₁_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (∂f₂_∂x₁, ∂f₂_∂x₂, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">             ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>If a specific argument has no partial derivative, then all corresponding argument values can instead be marked <code>@Constant</code>. For example, consider the case where <code>config</code> has no derivative.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@easy_rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config, x, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">             @setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@Constant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ∂f₁_∂x, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@Constant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ∂f₂_∂x, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">             ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Examples</strong></p><p>Let&#39;s write an <code>@easy_rule</code> for a simple trigonometric function. Enzyme already has rules for <code>sin</code> and <code>cos</code>, but for the sake of illustration we can define a new pass-through function to oen of them to demostrate the <code>@easy_rule</code> interface.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mycos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> cos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># forward-mode rule for the new function</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EnzymeRules</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@easy_rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    mycos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractFloat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    @setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x),)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Then this rule can be tested by running <code>Enzyme.autodiff</code> and comparing with the result for the regular <code>cos</code> function:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">myderiv   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> autodiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Forward, mycos, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Duplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># -1.091157f0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">truederiv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> autodiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Forward, cos, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Duplicated</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2f0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># -1.091157f0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> myderiv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> truederiv</span></span></code></pre></div><p>For more information about easy rules, see the <a href="./@ref man-easy-rule">manual</a>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.17/src/easyrules.jl#L678-L755" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/EnzymeAD/Reactant.jl/edit/main/docs/src/api/internal.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page on GitHub<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Reactant.jl/previews/PR1910/api/xla" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa>XLA</span><!--]--></a></div><div class="pager" data-v-4f9813fa><!----></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://documenter.juliadocs.org/stable/" target="_blank"><strong>Documenter.jl</strong></a>, <a href="https://vitepress.dev" target="_blank"><strong>VitePress</strong></a> and <a href="https://luxdl.github.io/DocumenterVitepress.jl/stable" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href="https://www.julialang.org">Julia Programming Language</a>.<br></p><p class="copyright" data-v-c970a860>© Copyright 2025 Reactant Development Team.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api_api.md\":\"DK-KHtd6\",\"api_config.md\":\"Bs6HItTn\",\"api_dialects_affine.md\":\"CfzOE92v\",\"api_dialects_arith.md\":\"CIRCU9bb\",\"api_dialects_builtin.md\":\"C2mUXS3v\",\"api_dialects_chlo.md\":\"CHsNifVN\",\"api_dialects_enzyme.md\":\"R67GzbT_\",\"api_dialects_enzymexla.md\":\"D-9aSNCN\",\"api_dialects_func.md\":\"CvO9Ja3A\",\"api_dialects_gpu.md\":\"C8WMp1gc\",\"api_dialects_llvm.md\":\"CdUtKeA_\",\"api_dialects_memref.md\":\"C2tr1EML\",\"api_dialects_mosaicgpu.md\":\"DmGXmhgv\",\"api_dialects_mpi.md\":\"jbclts2F\",\"api_dialects_nvvm.md\":\"0oXduqDb\",\"api_dialects_shardy.md\":\"Bem-omNn\",\"api_dialects_sparsetensor.md\":\"-6mGqR7I\",\"api_dialects_stablehlo.md\":\"DQnoxnoT\",\"api_dialects_tpu.md\":\"d5hJaEhj\",\"api_dialects_triton.md\":\"DmhVLE1a\",\"api_dialects_tritonext.md\":\"DrySivcQ\",\"api_dialects_vhlo.md\":\"C2VVlRyP\",\"api_internal.md\":\"_wqoyST0\",\"api_mlirc.md\":\"BYsm4Te8\",\"api_ops.md\":\"BNvuIeG0\",\"api_serialization.md\":\"BKHkGtSq\",\"api_sharding.md\":\"bGo6uCxv\",\"api_xla.md\":\"DROHZr8P\",\"index.md\":\"C3A-ZvUu\",\"introduction_configuration.md\":\"CWJsggHb\",\"introduction_faqs.md\":\"Bue9fhzH\",\"introduction_index.md\":\"BbUBE_Ja\",\"tutorials_automatic-differentiation.md\":\"DhgDhc35\",\"tutorials_control-flow.md\":\"BYwlJj2a\",\"tutorials_index.md\":\"DgpyytXq\",\"tutorials_local-build.md\":\"BQnbMmsE\",\"tutorials_multihost.md\":\"CEB2rPZS\",\"tutorials_partial-evaluation.md\":\"BACQxGro\",\"tutorials_persistent_compile_cache.md\":\"B__qt3c9\",\"tutorials_profiling.md\":\"Cn8OU93M\",\"tutorials_sharding.md\":\"Qa-MILHv\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Reactant.jl\",\"description\":\"Documentation for Reactant.jl\",\"base\":\"/Reactant.jl/previews/PR1910/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"light\":\"/logo.svg\",\"dark\":\"/logo.svg\"},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Getting Started\",\"items\":[{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Configuration\",\"link\":\"/introduction/configuration\"},{\"text\":\"FAQs\",\"link\":\"/introduction/FAQs\"}]},{\"text\":\"Benchmarks\",\"link\":\"https://enzymead.github.io/Reactant.jl/benchmarks/\"},{\"text\":\"Tutorials\",\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/\"},{\"text\":\"Partial Evaluation\",\"link\":\"/tutorials/partial-evaluation\"},{\"text\":\"Control Flow\",\"link\":\"/tutorials/control-flow\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/tutorials/automatic-differentiation\"},{\"text\":\"Sharding\",\"link\":\"/tutorials/sharding\"},{\"text\":\"Profiling\",\"link\":\"/tutorials/profiling\"},{\"text\":\"Multi-Host Environments\",\"link\":\"/tutorials/multihost\"},{\"text\":\"Local build\",\"link\":\"/tutorials/local-build\"},{\"text\":\"Persistent Compilation Cache\",\"link\":\"/tutorials/persistent_compile_cache\"}]},{\"text\":\"API\",\"items\":[{\"text\":\"Core Reactant API\",\"link\":\"/api/api\"},{\"text\":\"Sharding\",\"link\":\"/api/sharding\"},{\"text\":\"Serialization\",\"link\":\"/api/serialization\"},{\"text\":\"Ops\",\"link\":\"/api/ops\"},{\"text\":\"Configuration\",\"link\":\"/api/config\"},{\"text\":\"MLIR Dialects\",\"items\":[{\"text\":\"ArithOps\",\"link\":\"/api/dialects/arith\"},{\"text\":\"Affine\",\"link\":\"/api/dialects/affine\"},{\"text\":\"Builtin\",\"link\":\"/api/dialects/builtin\"},{\"text\":\"Chlo\",\"link\":\"/api/dialects/chlo\"},{\"text\":\"Enzyme\",\"link\":\"/api/dialects/enzyme\"},{\"text\":\"EnzymeXLA\",\"link\":\"/api/dialects/enzymexla\"},{\"text\":\"Func\",\"link\":\"/api/dialects/func\"},{\"text\":\"GPU\",\"link\":\"/api/dialects/gpu\"},{\"text\":\"LLVM\",\"link\":\"/api/dialects/llvm\"},{\"text\":\"MPI\",\"link\":\"/api/dialects/mpi\"},{\"text\":\"MemRef\",\"link\":\"/api/dialects/memref\"},{\"text\":\"Mosaic GPU\",\"link\":\"/api/dialects/mosaicgpu\"},{\"text\":\"NVVM\",\"link\":\"/api/dialects/nvvm\"},{\"text\":\"Shardy\",\"link\":\"/api/dialects/shardy\"},{\"text\":\"SparseTensor\",\"link\":\"/api/dialects/sparsetensor\"},{\"text\":\"StableHLO\",\"link\":\"/api/dialects/stablehlo\"},{\"text\":\"Triton\",\"link\":\"/api/dialects/triton\"},{\"text\":\"TritonExt\",\"link\":\"/api/dialects/tritonext\"},{\"text\":\"TPU\",\"link\":\"/api/dialects/tpu\"},{\"text\":\"VHLO\",\"link\":\"/api/dialects/vhlo\"}]},{\"text\":\"Low-Level API\",\"items\":[{\"text\":\"MLIR API\",\"link\":\"/api/mlirc\"},{\"text\":\"XLA\",\"link\":\"/api/xla\"}]},{\"text\":\"Internal API\",\"link\":\"/api/internal\"}]},{\"component\":\"VersionPicker\"}],\"sidebar\":{\"/introduction/\":[{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"Introduction\",\"link\":\"/introduction\"},{\"text\":\"Configuration\",\"link\":\"/introduction/configuration\"},{\"text\":\"FAQs\",\"link\":\"/introduction/FAQs\"}]}],\"/tutorials/\":[{\"text\":\"Tutorials\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/tutorials/\"},{\"text\":\"Partial Evaluation\",\"link\":\"/tutorials/partial-evaluation\"},{\"text\":\"Control Flow\",\"link\":\"/tutorials/control-flow\"},{\"text\":\"Automatic Differentiation\",\"link\":\"/tutorials/automatic-differentiation\"},{\"text\":\"Sharding\",\"link\":\"/tutorials/sharding\"},{\"text\":\"Profiling\",\"link\":\"/tutorials/profiling\"},{\"text\":\"Multi-Host Environments\",\"link\":\"/tutorials/multihost\"},{\"text\":\"Local build\",\"link\":\"/tutorials/local-build\"},{\"text\":\"Persistent Compilation Cache\",\"link\":\"/tutorials/persistent_compile_cache\"}]}],\"/api/\":[{\"text\":\"API Reference\",\"collapsed\":false,\"items\":[{\"text\":\"Reactant API\",\"link\":\"/api/api\"},{\"text\":\"Sharding\",\"link\":\"/api/sharding\"},{\"text\":\"Serialization\",\"link\":\"/api/serialization\"},{\"text\":\"Ops\",\"link\":\"/api/ops\"},{\"text\":\"Configuration\",\"link\":\"/api/config\"},{\"text\":\"MLIR Dialects\",\"collapsed\":false,\"items\":[{\"text\":\"ArithOps\",\"link\":\"/api/dialects/arith\"},{\"text\":\"Affine\",\"link\":\"/api/dialects/affine\"},{\"text\":\"Builtin\",\"link\":\"/api/dialects/builtin\"},{\"text\":\"Chlo\",\"link\":\"/api/dialects/chlo\"},{\"text\":\"Enzyme\",\"link\":\"/api/dialects/enzyme\"},{\"text\":\"EnzymeXLA\",\"link\":\"/api/dialects/enzymexla\"},{\"text\":\"Func\",\"link\":\"/api/dialects/func\"},{\"text\":\"GPU\",\"link\":\"/api/dialects/gpu\"},{\"text\":\"LLVM\",\"link\":\"/api/dialects/llvm\"},{\"text\":\"MPI\",\"link\":\"/api/dialects/mpi\"},{\"text\":\"MemRef\",\"link\":\"/api/dialects/memref\"},{\"text\":\"Mosaic GPU\",\"link\":\"/api/dialects/mosaicgpu\"},{\"text\":\"NVVM\",\"link\":\"/api/dialects/nvvm\"},{\"text\":\"Shardy\",\"link\":\"/api/dialects/shardy\"},{\"text\":\"SparseTensor\",\"link\":\"/api/dialects/sparsetensor\"},{\"text\":\"StableHLO\",\"link\":\"/api/dialects/stablehlo\"},{\"text\":\"Triton\",\"link\":\"/api/dialects/triton\"},{\"text\":\"TritonExt\",\"link\":\"/api/dialects/tritonext\"},{\"text\":\"TPU\",\"link\":\"/api/dialects/tpu\"},{\"text\":\"VHLO\",\"link\":\"/api/dialects/vhlo\"}]},{\"text\":\"Low-Level API\",\"collapsed\":false,\"items\":[{\"text\":\"MLIR API\",\"link\":\"/api/mlirc\"},{\"text\":\"XLA\",\"link\":\"/api/xla\"}]},{\"text\":\"Internal API\",\"link\":\"/api/internal\"}]}]},\"editLink\":{\"pattern\":\"https://github.com/EnzymeAD/Reactant.jl/edit/main/docs/src/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"slack\",\"link\":\"https://julialang.org/slack/\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://documenter.juliadocs.org/stable/\\\" target=\\\"_blank\\\"><strong>Documenter.jl</strong></a>, <a href=\\\"https://vitepress.dev\\\" target=\\\"_blank\\\"><strong>VitePress</strong></a> and <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/stable\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>Released under the MIT License. Powered by the <a href=\\\"https://www.julialang.org\\\">Julia Programming Language</a>.<br>\",\"copyright\":\"© Copyright 2025 Reactant Development Team.\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>