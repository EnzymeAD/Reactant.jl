import{_ as n,C as c,c as r,o as d,j as t,a as o,al as l,G as s,w as i}from"./chunks/framework.CCl4LAzO.js";const k=JSON.parse('{"title":"Mosaic GPU Dialect","description":"","frontmatter":{},"headers":[],"relativePath":"api/dialects/mosaicgpu.md","filePath":"api/dialects/mosaicgpu.md","lastUpdated":null}'),u={name:"api/dialects/mosaicgpu.md"},p={class:"jldocstring custom-block"},m={class:"jldocstring custom-block"},f={class:"jldocstring custom-block"},b={class:"jldocstring custom-block"},h={class:"jldocstring custom-block"},R={class:"jldocstring custom-block"},M={class:"jldocstring custom-block"},g={class:"jldocstring custom-block"},y={class:"jldocstring custom-block"},_={class:"jldocstring custom-block"};function I(T,e,L,j,D,w){const a=c("Badge");return d(),r("div",null,[e[51]||(e[51]=t("h1",{id:"Mosaic-GPU-Dialect",tabindex:"-1"},[o("Mosaic GPU Dialect "),t("a",{class:"header-anchor",href:"#Mosaic-GPU-Dialect","aria-label":'Permalink to "Mosaic GPU Dialect {#Mosaic-GPU-Dialect}"'},"â€‹")],-1)),t("details",p,[t("summary",null,[e[0]||(e[0]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.async_load",href:"#Reactant.MLIR.Dialects.mosaic_gpu.async_load"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.async_load")],-1)),e[1]||(e[1]=o()),s(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),e[3]||(e[3]=l("",7)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[2]||(e[2]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L35-L67",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[2]})]),t("details",m,[t("summary",null,[e[4]||(e[4]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.async_store",href:"#Reactant.MLIR.Dialects.mosaic_gpu.async_store"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.async_store")],-1)),e[5]||(e[5]=o()),s(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),e[7]||(e[7]=l("",5)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[6]||(e[6]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L104-L125",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[6]})]),t("details",f,[t("summary",null,[e[8]||(e[8]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.broadcast_in_dim-Tuple{Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.broadcast_in_dim-Tuple{Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.broadcast_in_dim")],-1)),e[9]||(e[9]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[11]||(e[11]=t("p",null,[t("code",null,"broadcast_in_dim")],-1)),e[12]||(e[12]=t("p",null,[t("code",null,"broadcast_dimensions"),o(" must have the same size as the rank of the input vector and for each input dimension, specifies which output dimension it corresponds to.")],-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[10]||(e[10]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L160-L166",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[10]})]),t("details",b,[t("summary",null,[e[13]||(e[13]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.custom_primitive-Tuple{Vector{Reactant.MLIR.IR.Value}}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.custom_primitive-Tuple{Vector{Reactant.MLIR.IR.Value}}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.custom_primitive")],-1)),e[14]||(e[14]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[16]||(e[16]=t("p",null,[t("code",null,"custom_primitive")],-1)),e[17]||(e[17]=t("p",null,"Allows defining a custom Mosaic GPU primitive.",-1)),e[18]||(e[18]=t("p",null,"Custom primitives should carry input and output layouts for each of their vector operands and outputs, and input transforms for each of their memref operands that live in SMEM.",-1)),e[19]||(e[19]=t("p",null,"Custom primitives can only return vectors.",-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[15]||(e[15]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L190-L200",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[15]})]),t("details",h,[t("summary",null,[e[20]||(e[20]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.initialize_barrier-Tuple{Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.initialize_barrier-Tuple{Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.initialize_barrier")],-1)),e[21]||(e[21]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[23]||(e[23]=t("p",null,[t("code",null,"initialize_barrier")],-1)),e[24]||(e[24]=t("p",null,[o("Initializes a memref of barriers each meant to synchronize exactly "),t("code",null,"arrival_count"),o(" threads.")],-1)),e[25]||(e[25]=t("p",null,[o("The base pointer of the result memref corresponds to "),t("code",null,"base_pointer"),o(", which must be a pointer to a shared memory location.")],-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[22]||(e[22]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L232-L240",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[22]})]),t("details",R,[t("summary",null,[e[26]||(e[26]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.layout_cast-Tuple{Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.layout_cast-Tuple{Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.layout_cast")],-1)),e[27]||(e[27]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[29]||(e[29]=t("p",null,[t("code",null,"layout_cast"),o(" Casts a vector value to a new strided or tiled layout.")],-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[28]||(e[28]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L262-L265",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[28]})]),t("details",M,[t("summary",null,[e[30]||(e[30]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.return_-Tuple{Vector{Reactant.MLIR.IR.Value}}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.return_-Tuple{Vector{Reactant.MLIR.IR.Value}}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.return_")],-1)),e[31]||(e[31]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[33]||(e[33]=t("p",null,[t("code",null,"return_")],-1)),e[34]||(e[34]=t("p",null,[o("The "),t("code",null,"return"),o(" op is a terminator that indicates the end of execution within a "),t("code",null,"CustomPrimitiveOp"),o("'s region. It can optionally return some values, which become the results of the parent "),t("code",null,"CustomPrimitiveOp"),o(".")],-1)),e[35]||(e[35]=t("p",null,[o("The declared results of the parent "),t("code",null,"CustomPrimitiveOp"),o(" must match the operand types of this op.")],-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[32]||(e[32]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L312-L321",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[32]})]),t("details",g,[t("summary",null,[e[36]||(e[36]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.wait-Tuple{Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.wait-Tuple{Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.wait")],-1)),e[37]||(e[37]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[39]||(e[39]=t("p",null,[t("code",null,"wait")],-1)),e[40]||(e[40]=t("p",null,"All threads in the warpgroup will block, waiting on the provided barrier until:",-1)),e[41]||(e[41]=t("ul",null,[t("li",null,[t("p",null,"all pending threads have arrived on the barrier")]),t("li",null,[t("p",null,"all expected byte transfers have been completed")]),t("li",null,[t("p",null,"the barrier's parity matches the provided parity")])],-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[38]||(e[38]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L420-L428",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[38]})]),t("details",y,[t("summary",null,[e[42]||(e[42]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.wgmma-Tuple{Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.wgmma-Tuple{Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value, Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.wgmma")],-1)),e[43]||(e[43]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[45]||(e[45]=l("",11)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[44]||(e[44]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L360-L393",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[44]})]),t("details",_,[t("summary",null,[e[46]||(e[46]=t("a",{id:"Reactant.MLIR.Dialects.mosaic_gpu.with_transforms-Tuple{Reactant.MLIR.IR.Value}",href:"#Reactant.MLIR.Dialects.mosaic_gpu.with_transforms-Tuple{Reactant.MLIR.IR.Value}"},[t("span",{class:"jlbinding"},"Reactant.MLIR.Dialects.mosaic_gpu.with_transforms")],-1)),e[47]||(e[47]=o()),s(a,{type:"info",class:"jlObjectType jlMethod",text:"Method"})]),e[49]||(e[49]=t("p",null,[t("code",null,"with_transforms")],-1)),e[50]||(e[50]=t("p",null,"This op enforces the provided transforms on the parameter memref.",-1)),s(a,{type:"info",class:"source-link",text:"source"},{default:i(()=>e[48]||(e[48]=[t("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/eff1b40b0c2309d9cfdd17f8b43b31e0ad4c7167/src/mlir/Dialects/MosaicGPU.jl#L448-L452",target:"_blank",rel:"noreferrer"},"source",-1)])),_:1,__:[48]})])])}const x=n(u,[["render",I]]);export{k as __pageData,x as default};
