import{_ as i,o as a,c as s,al as t}from"./chunks/framework.whEktkQR.js";const c=JSON.parse('{"title":"Debugging compilation errors","description":"","frontmatter":{},"headers":[],"relativePath":"tutorials/debugging.md","filePath":"tutorials/debugging.md","lastUpdated":null}'),n={name:"tutorials/debugging.md"};function l(o,e,h,p,r,d){return a(),s("div",null,[...e[0]||(e[0]=[t(`<h1 id="debugging-compilation" tabindex="-1">Debugging compilation errors <a class="header-anchor" href="#debugging-compilation" aria-label="Permalink to &quot;Debugging compilation errors {#debugging-compilation}&quot;">​</a></h1><p>It may happen that compilation of some functions via Reactant may fail, or <a href="/Reactant.jl/previews/PR2508/tutorials/raising#Raising">raising</a> may fail inside the Enzyme-JAX backend. Not to worry, we&#39;re here to help! But we need some help from you in order to look into the issue. Below are some information about how to gather information that can be useful to the Reactant developers to solve your problems.</p><h2 id="Enabling-debugging-messages-in-Reactant" tabindex="-1">Enabling debugging messages in Reactant <a class="header-anchor" href="#Enabling-debugging-messages-in-Reactant" aria-label="Permalink to &quot;Enabling debugging messages in Reactant {#Enabling-debugging-messages-in-Reactant}&quot;">​</a></h2><p>One option is to enable debugging message inside the <code>Reactant.jl</code> package. This can be achieved by setting the environment variable <a href="https://docs.julialang.org/en/v1/manual/environment-variables/#JULIA_DEBUG" target="_blank" rel="noreferrer"><code>JULIA_DEBUG</code></a> to <code>Reactant</code>. This can be achieved by either exporting the variable before starting the Julia process</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JULIA_DEBUG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reactant</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">julia</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># or...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">JULIA_DEBUG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Reactant</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> julia</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...</span></span></code></pre></div><p>or inside your Julia code/REPL with</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;JULIA_DEBUG&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Reactant&quot;</span></span></code></pre></div><p>before loading the Reactant module. Some of the debugging messages can provide information</p><h2 id="Dumping-all-MLIR-modules" tabindex="-1">Dumping all MLIR modules <a class="header-anchor" href="#Dumping-all-MLIR-modules" aria-label="Permalink to &quot;Dumping all MLIR modules {#Dumping-all-MLIR-modules}&quot;">​</a></h2><p>During its compilation pipeline, Reactant generates several MLIR modules, which go through a few stages of optimisation before generating the native code for the device you want to run the code on. By default these modules are simply kept in memory, but for debugging purposes (especially for raising failures) it may be useful to save to disk all MLIR modules, which you can then share with the Reactant developers to help them fix bugs. To do this, inside your Julia code/REPL set</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MLIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DUMP_MLIR_ALWAYS[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span></code></pre></div><p>before the offending compilation.</p><div class="tip custom-block"><p class="custom-block-title">Changing directory where the MLIR modules are saved</p><p>The MLIR modules are saved by default in a subdirectory whose name starts with <code>reactant_</code> under <a href="https://docs.julialang.org/en/v1/base/file/#Base.Filesystem.tempdir" target="_blank" rel="noreferrer"><code>tempdir()</code></a>. Regularly you don&#39;t need to do this, but in the remote case you wanted to point <code>tempdir()</code> somewhere else, see the docstring of that function for how to change the location of the temporary directory. Alternatively, if you want to change only the directory where the MLIR modules are saved to (without changing the location of <code>tempdir()</code>), in your Julia code set the variable</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MLIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DUMP_MLIR_DIR[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">directory</span></span></code></pre></div><p>together with setting <code>Reactant.MLIR.IR.DUMP_MLIR_ALWAYS</code> as suggested above.</p></div><p>When the stacktrace of the error thrown during compilation mentions the pass manager (e.g. functions like <code>mlirPassManagerRunOnOp</code>, <code>run_pass_pipeline!</code>, etc.), the file we want to look at is the last one saved to disk (they&#39;re numbered, using an increasing counter) whose name looks like <code>module_.*_pre_all_pm.mlir</code>.</p>`,14)])])}const k=i(n,[["render",l]]);export{c as __pageData,k as default};
