import{_ as p,C as o,o as r,c as h,j as s,a as t,E as e,al as n,w as l}from"./chunks/framework.BeweaR5m.js";const ii=JSON.parse('{"title":"Core Reactant API","description":"","frontmatter":{},"headers":[],"relativePath":"api/api.md","filePath":"api/api.md","lastUpdated":null}'),d={name:"api/api.md"},k={class:"jldocstring custom-block"},c={class:"jldocstring custom-block"},g={class:"jldocstring custom-block"},u={class:"jldocstring custom-block"},y={class:"jldocstring custom-block"},f={class:"jldocstring custom-block"},E={class:"jldocstring custom-block"},m={class:"jldocstring custom-block"},b={class:"jldocstring custom-block"},C={class:"jldocstring custom-block"},F={class:"jldocstring custom-block"},_={class:"jldocstring custom-block"},A={class:"jldocstring custom-block"},v={class:"jldocstring custom-block"},j={class:"jldocstring custom-block"},R={class:"jldocstring custom-block"},D={class:"jldocstring custom-block"},T={class:"jldocstring custom-block"},x={class:"jldocstring custom-block"},P={class:"jldocstring custom-block"},w={class:"jldocstring custom-block"},B={class:"jldocstring custom-block"},I={class:"jldocstring custom-block"},S={class:"jldocstring custom-block"},O={class:"jldocstring custom-block"},L={class:"jldocstring custom-block"},z={class:"jldocstring custom-block"},N={class:"jldocstring custom-block"},V={class:"jldocstring custom-block"},X={class:"jldocstring custom-block"},M={class:"jldocstring custom-block"},q={class:"jldocstring custom-block"},H={class:"jldocstring custom-block"},U={class:"jldocstring custom-block"},G={class:"jldocstring custom-block"};function J(W,i,$,K,Y,Q){const a=o("Badge");return r(),h("div",null,[i[140]||(i[140]=s("h1",{id:"Core-Reactant-API",tabindex:"-1"},[t("Core Reactant API "),s("a",{class:"header-anchor",href:"#Core-Reactant-API","aria-label":'Permalink to "Core Reactant API {#Core-Reactant-API}"'},"​")],-1)),i[141]||(i[141]=s("h2",{id:"Compile-API",tabindex:"-1"},[t("Compile API "),s("a",{class:"header-anchor",href:"#Compile-API","aria-label":'Permalink to "Compile API {#Compile-API}"'},"​")],-1)),s("details",k,[s("summary",null,[i[0]||(i[0]=s("a",{id:"Reactant.Compiler.@compile",href:"#Reactant.Compiler.@compile"},[s("span",{class:"jlbinding"},"Reactant.Compiler.@compile")],-1)),i[1]||(i[1]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[3]||(i[3]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@compile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [optimize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [no_nan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [sync </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compile the function <code>f</code> with arguments <code>args</code> and return the compiled function.</p><p><strong>Note</strong></p><p>Note that <code>@compile foo(bar(x))</code> is equivalent to</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># first compute the output of `bar(x)`, say `y`</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@compile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># then compile `foo` for `y`</span></span></code></pre></div><p>That is, like <code>@jit</code>, <code>@compile</code> only applies to the outermost function call; it does <em>not</em> compile the composed function <code>foo(bar(x))</code> jointly. Hence, if you want to compile the composed function <code>foo(bar(x))</code> jointly, you need to introduce an intermediate function, i.e.,</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">baz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x))</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@compile</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> baz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p><strong>Options</strong></p><ul><li><p><code>sync</code>: Reactant computations are asynchronous by default. If <code>true</code>, the computation will be executed synchronously, blocking till the computation is complete. This is recommended when benchmarking.</p></li><li><p><code>compile_options</code>: If provided, then all other compilation options will be ignored. This should be an object of type <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p></li><li><p><code>optimize</code>: This option maps to the <code>optimization_passes</code> field of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>. See the documentation of <code>CompileOptions</code> for more details.</p></li><li><p><code>client</code>: XLA Client used for compilation. If not specified, the default client is used.</p></li></ul><p>For details about other compilation options see the documentation of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><ul><li><code>serializable</code>: If <code>true</code>, the compiled function will be serializable. This is needed for saving the compiled function to disk and loading it later. Defaults to <code>false</code>.</li></ul><p>See also <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@jit"><code>@jit</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_mhlo"><code>@code_mhlo</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_xla"><code>@code_xla</code></a>.</p>',12)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[2]||(i[2]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2999-L3026",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",c,[s("summary",null,[i[4]||(i[4]=s("a",{id:"Reactant.Compiler.@jit",href:"#Reactant.Compiler.@jit"},[s("span",{class:"jlbinding"},"Reactant.Compiler.@jit")],-1)),i[5]||(i[5]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[7]||(i[7]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@jit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [optimize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [no_nan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [sync </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Run @compile f(args..) then immediately execute it. Most users should use <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@compile"><code>@compile</code></a> instead to cache the compiled function and execute it later.</p><p><strong>Note</strong></p><p>Note that <code>@jit foo(bar(x))</code> is equivalent to</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># first compute the output of `bar(x)`, say `y`</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@jit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># then compile `foo` for `y` and execute it</span></span></code></pre></div><p>That is, like <code>@compile</code>, <code>@jit</code> only applies to the outermost function call; it does <em>not</em> compile the composed function <code>foo(bar(x))</code> jointly. Hence, if you want to compile the composed function <code>foo(bar(x))</code> jointly, you need to introduce an intermediate function, i.e.,</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">baz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x))</span></span>\n<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@jit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> baz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p><strong>Options</strong></p><ul><li><p><code>sync</code>: Reactant computations are asynchronous by default. If <code>true</code>, the computation will be executed synchronously, blocking till the computation is complete. This is recommended when benchmarking.</p></li><li><p><code>compile_options</code>: If provided, then all other compilation options will be ignored. This should be an object of type <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p></li><li><p><code>optimize</code>: This option maps to the <code>optimization_passes</code> field of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>. See the documentation of <code>CompileOptions</code> for more details.</p></li><li><p><code>client</code>: XLA Client used for compilation. If not specified, the default client is used.</p></li></ul><p>For details about other compilation options see the documentation of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><p>See also <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@compile"><code>@compile</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_mhlo"><code>@code_mhlo</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_xla"><code>@code_xla</code></a>.</p>',11)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[6]||(i[6]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L3048-L3074",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[142]||(i[142]=s("h2",{id:"ReactantCore-API",tabindex:"-1"},[t("ReactantCore API "),s("a",{class:"header-anchor",href:"#ReactantCore-API","aria-label":'Permalink to "ReactantCore API {#ReactantCore-API}"'},"​")],-1)),s("details",g,[s("summary",null,[i[8]||(i[8]=s("a",{id:"ReactantCore.within_compile",href:"#ReactantCore.within_compile"},[s("span",{class:"jlbinding"},"ReactantCore.within_compile")],-1)),i[9]||(i[9]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[11]||(i[11]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">within_compile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>Returns true if this function is executed in a Reactant compilation context, otherwise false.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[10]||(i[10]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/lib/ReactantCore/src/ReactantCore.jl#L41-L45",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",u,[s("summary",null,[i[12]||(i[12]=s("a",{id:"ReactantCore.@trace",href:"#ReactantCore.@trace"},[s("span",{class:"jlbinding"},"ReactantCore.@trace")],-1)),i[13]||(i[13]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[15]||(i[15]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> val,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">expr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p>Converts certain expressions like control flow into a Reactant friendly form. Importantly, if no traced value is found inside the expression, then there is no overhead.</p><p><strong>Currently Supported</strong></p><ul><li><p><code>if</code> conditions (with <code>elseif</code> and other niceties) (<code>@trace if ...</code>)</p></li><li><p><code>if</code> statements with a preceeding assignment (<code>@trace a = if ...</code>) (note the positioning of the macro needs to be before the assignment and not before the <code>if</code>)</p></li><li><p><code>for</code> statements with a single induction variable iterating over integers with known <code>step</code></p></li><li><p><code>while</code> statements</p></li></ul><p><strong>Special Considerations</strong></p><ul><li>Apply <code>@trace</code> only at the outermost <code>if</code>. Nested <code>if</code> statements will be automatically expanded into the correct form.</li></ul><p><strong>Extended Help</strong></p><p><strong>Caveats (Deviations from Core Julia Semantics)</strong></p><p><strong>New variables introduced</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    p </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>In the outer scope <code>p</code> is not defined if <code>x ≤ 0</code>. However, for the traced version, it is defined and set to a dummy value.</p><p><strong>Short Circuiting Operations</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p><code>&amp;&amp;</code> and <code>||</code> are short circuiting operations. In the traced version, we replace them with <code>&amp;</code> and <code>|</code> respectively.</p><p><strong>Type-Unstable Branches</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0f0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>This will not compile since <code>y</code> is a <code>Float32</code> in one branch and a <code>Float64</code> in the other. You need to ensure that all branches have the same type.</p><p>Another example is the following for loop which changes the type of <code>x</code> between iterations.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # ConcreteRArray{Int64, 1}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5f0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10f0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ConcreteRArray{Float32, 1}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p><strong>Certain Symbols are Reserved</strong></p><p>Symbols like <code>[:(:), :nothing, :missing, :Inf, :Inf16, :Inf32, :Inf64, :Base, :Core]</code> are not allowed as variables in <code>@trace</code> expressions. While certain cases might work but these are not guaranteed to work. For example, the following will not work:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    nothing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    @trace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p><strong>Configuration</strong></p><p>The behavior of loops can be configured with the following configuration options:</p><ul><li><p><code>track_numbers::Union{Bool,Datatype}</code> - whether Julia numbers should be automatically promoted to traced numbers upon entering the loop.</p></li><li><p><code>checkpointing::Bool</code> - whether or not to enable checkpointing when performing reverse mode differentiation (default: <code>false</code>).</p></li><li><p><code>mincut::Bool</code> - whether or not to enable the mincut algorithm when performing reverse mode differentiation (default: <code>false</code>).</p></li></ul>`,25)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[14]||(i[14]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/lib/ReactantCore/src/ReactantCore.jl#L49-L145",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[143]||(i[143]=s("h2",{id:"Reactant-data-types",tabindex:"-1"},[t("Reactant data types "),s("a",{class:"header-anchor",href:"#Reactant-data-types","aria-label":'Permalink to "Reactant data types {#Reactant-data-types}"'},"​")],-1)),s("details",y,[s("summary",null,[i[16]||(i[16]=s("a",{id:"Reactant.ConcreteRArray",href:"#Reactant.ConcreteRArray"},[s("span",{class:"jlbinding"},"Reactant.ConcreteRArray")],-1)),i[17]||(i[17]=t()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),i[19]||(i[19]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConcreteRArray{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    undef, shape</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dims</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    client</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Nothing,XLA.AbstractClient}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Nothing,XLA.AbstractDevice}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Sharding.AbstractSharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Sharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NoSharding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConcretePJRTArray{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(undef, shape</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Integer...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConcretePJRTArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Allocate an uninitialized <code>ConcreteRArray</code> of element type <code>T</code> and size <code>shape</code> or convert an <code>Array</code> to a <code>ConcreteRArray</code>.</p><p><strong>Implementation</strong></p><p>Depending on the Reactant <code>xla_runtime</code> preference setting, <code>ConcreteRArray</code> is an alias for <code>ConcretePJRTArray</code> or <code>ConcreteIFRTArray</code>. User code should use <code>ConcreteRArray</code>.</p>`,4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[18]||(i[18]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Types.jl#L470-L490",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",f,[s("summary",null,[i[20]||(i[20]=s("a",{id:"Reactant.ConcreteRNumber",href:"#Reactant.ConcreteRNumber"},[s("span",{class:"jlbinding"},"Reactant.ConcreteRNumber")],-1)),i[21]||(i[21]=t()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),i[23]||(i[23]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConcreteRNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    client</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Nothing,XLA.AbstractClient}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Union{Nothing,XLA.AbstractDevice}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Sharding.AbstractSharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Sharding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NoSharding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ConcreteRNumber{T&lt;:Number}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Wrap a <code>Number</code> in a <code>ConcreteRNumber</code>.</p><p><strong>Implementation</strong></p><p>Depending on the Reactant <code>xla_runtime</code> preference setting, <code>ConcreteRArray</code> is an alias for <code>ConcretePJRTNumber</code> or <code>ConcreteIFRTNumber</code>. User code should use <code>ConcreteRNumber</code>.</p>`,4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[22]||(i[22]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Types.jl#L497-L514",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[144]||(i[144]=s("h2",{id:"Inspect-Generated-HLO",tabindex:"-1"},[t("Inspect Generated HLO "),s("a",{class:"header-anchor",href:"#Inspect-Generated-HLO","aria-label":'Permalink to "Inspect Generated HLO {#Inspect-Generated-HLO}"'},"​")],-1)),s("details",E,[s("summary",null,[i[24]||(i[24]=s("a",{id:"Reactant.Compiler.@code_hlo",href:"#Reactant.Compiler.@code_hlo"},[s("span",{class:"jlbinding"},"Reactant.Compiler.@code_hlo")],-1)),i[25]||(i[25]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[27]||(i[27]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@code_hlo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [optimize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [no_nan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Prints the compiled MLIR module for the function <code>f</code> with arguments <code>args</code>.</p><p><strong>Options</strong></p><ul><li><p><code>compile_options</code>: If provided, then all other compilation options will be ignored. This should be an object of type <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p></li><li><p><code>optimize</code>: This option maps to the <code>optimization_passes</code> field of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>. See the documentation of <code>CompileOptions</code> for more details.</p></li><li><p><code>client</code>: XLA Client used for compilation. If not specified, the default client is used.</p></li></ul><p>For details about other compilation options see the documentation of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><p>See also <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_xla"><code>@code_xla</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_mhlo"><code>@code_mhlo</code></a>.</p>',6)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[26]||(i[26]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2858-L2868",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",m,[s("summary",null,[i[28]||(i[28]=s("a",{id:"Reactant.Compiler.@code_mhlo",href:"#Reactant.Compiler.@code_mhlo"},[s("span",{class:"jlbinding"},"Reactant.Compiler.@code_mhlo")],-1)),i[29]||(i[29]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[31]||(i[31]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@code_mhlo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [optimize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [no_nan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Similar to <code>@code_hlo</code>, but runs additional passes to export the stablehlo module to MHLO.</p><p><strong>Options</strong></p><ul><li><p><code>compile_options</code>: If provided, then all other compilation options will be ignored. This should be an object of type <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p></li><li><p><code>optimize</code>: This option maps to the <code>optimization_passes</code> field of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>. See the documentation of <code>CompileOptions</code> for more details.</p></li><li><p><code>client</code>: XLA Client used for compilation. If not specified, the default client is used.</p></li></ul><p>For details about other compilation options see the documentation of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><p>See also <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_xla"><code>@code_xla</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>.</p>',6)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[30]||(i[30]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2909-L2919",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",b,[s("summary",null,[i[32]||(i[32]=s("a",{id:"Reactant.Compiler.@code_xla",href:"#Reactant.Compiler.@code_xla"},[s("span",{class:"jlbinding"},"Reactant.Compiler.@code_xla")],-1)),i[33]||(i[33]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[35]||(i[35]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@code_xla</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [optimize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [no_nan </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Similar to <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>, but runs additional XLA passes and exports MLIR to XLA HLO. This is the post optimizations XLA HLO module.</p><p><strong>Options</strong></p><ul><li><p><code>compile_options</code>: If provided, then all other compilation options will be ignored. This should be an object of type <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p></li><li><p><code>optimize</code>: This option maps to the <code>optimization_passes</code> field of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>. See the documentation of <code>CompileOptions</code> for more details.</p></li><li><p><code>client</code>: XLA Client used for compilation. If not specified, the default client is used.</p></li></ul><p>For details about other compilation options see the documentation of <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><ul><li><code>before_xla_optimizations</code>: If <code>true</code>, return the <code>before_optimizations</code> HLO module.</li></ul><p>See also <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_mhlo"><code>@code_mhlo</code></a>, <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>.</p>',7)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[34]||(i[34]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2964-L2976",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",C,[s("summary",null,[i[36]||(i[36]=s("a",{id:"Reactant.Compiler.code_hlo",href:"#Reactant.Compiler.code_hlo"},[s("span",{class:"jlbinding"},"Reactant.Compiler.code_hlo")],-1)),i[37]||(i[37]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[39]||(i[39]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">code_hlo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, f, args; fn_kwargs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compile the function <code>f</code> with arguments <code>args</code> and return the compiled MLIR module.</p><p>See also: <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_hlo"><code>@code_hlo</code></a>.</p>',3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[38]||(i[38]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2842-L2848",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",F,[s("summary",null,[i[40]||(i[40]=s("a",{id:"Reactant.Compiler.code_mhlo",href:"#Reactant.Compiler.code_mhlo"},[s("span",{class:"jlbinding"},"Reactant.Compiler.code_mhlo")],-1)),i[41]||(i[41]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[43]||(i[43]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">code_mhlo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, f, args; fn_kwargs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compile the function <code>f</code> with arguments <code>args</code> and return the compiled MLIR module.</p><p>See also: <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_mhlo"><code>@code_mhlo</code></a>.</p>',3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[42]||(i[42]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2892-L2898",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",_,[s("summary",null,[i[44]||(i[44]=s("a",{id:"Reactant.Compiler.code_xla",href:"#Reactant.Compiler.code_xla"},[s("span",{class:"jlbinding"},"Reactant.Compiler.code_xla")],-1)),i[45]||(i[45]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[47]||(i[47]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">code_xla</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, f, args; fn_kwargs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NamedTuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compile the function <code>f</code> with arguments <code>args</code> and return the compiled HLO module.</p><p>See also: <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@code_xla"><code>@code_xla</code></a>.</p>',3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[46]||(i[46]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Compiler.jl#L2948-L2954",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[145]||(i[145]=s("h2",{id:"Compile-Options",tabindex:"-1"},[t("Compile Options "),s("a",{class:"header-anchor",href:"#Compile-Options","aria-label":'Permalink to "Compile Options {#Compile-Options}"'},"​")],-1)),s("details",A,[s("summary",null,[i[48]||(i[48]=s("a",{id:"Reactant.CompileOptions",href:"#Reactant.CompileOptions"},[s("span",{class:"jlbinding"},"Reactant.CompileOptions")],-1)),i[49]||(i[49]=t()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),i[51]||(i[51]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CompileOptions</span></span></code></pre></div><p>Fine-grained control over the compilation options for the Reactant compiler.</p><p><strong>Controlling Optimization Passes</strong></p><ul><li><p><code>optimization_passes</code>: Optimizations passes to run on the traced MLIR code. Valid types of values are:</p><ul><li><p>Bool (true/false): whether to run the optimization passes or not. Defaults to <code>true</code>.</p></li><li><p>String: a custom string with the passes to run. The string should be a comma-separated list of MLIR passes. For example, <code>&quot;canonicalize,enzyme-hlo-opt&quot;</code>.</p></li><li><p>Symbol: a predefined set of passes to run. Valid options are:</p><ol><li><p><code>:all</code>: Default set of optimization passes. The exact set of passes are not fixed and may change in future versions of Reactant. It is recommended to use this option for most users.</p></li><li><p><code>:none</code>: No optimization passes will be run.</p></li><li><p>Other predefined options are: <code>:before_kernel</code>, <code>:before_jit</code>, <code>:before_raise</code>, <code>:before_enzyme</code>, <code>:after_enzyme</code>, <code>:just_batch</code>, <code>:canonicalize</code>, <code>:only_enzyme</code>.</p></li></ol></li></ul></li><li><p><code>no_nan</code>: If <code>true</code>, the optimization passes will assume that the function does not produce NaN values. This can lead to more aggressive optimizations <strong>(and potentially incorrect results if the function does produce NaN values)</strong>.</p></li><li><p><code>all_finite</code>: If <code>true</code>, the optimization passes will assume that the function does not produce Inf or -Inf values. This can lead to more aggressive optimizations <strong>(and potentially incorrect results if the function does produce Inf or -Inf values)</strong>.</p></li><li><p><code>transpose_propagate</code>: If <code>:up</code>, <code>stablehlo.transpose</code> operations will be propagated up the computation graph. If <code>:down</code>, they will be propagated down. Defaults to <code>:up</code>.</p></li><li><p><code>reshape_propagate</code>: If <code>:up</code>, <code>stablehlo.reshape</code> operations will be propagated up the computation graph. If <code>:down</code>, they will be propagated down. Defaults to <code>:up</code>.</p></li><li><p><code>max_constant_threshold</code>: If the number of elements in a constant is greater than this threshold (for a non-splatted constant), we will throw an error.</p></li><li><p><code>inline</code>: If <code>true</code>, all functions will be inlined. (Default: <code>true</code>).</p></li></ul><p><strong>Raising Options</strong></p><ul><li><p><code>raise</code>: If <code>true</code>, the function will be compiled with the raising pass, which raises CUDA and KernelAbstractions kernels to HLO. Defaults to <code>false</code>, but is automatically activated if the inputs are sharded.</p></li><li><p><code>raise_first</code>: If <code>true</code>, the raising pass will be run before the optimization passes. Defaults to <code>false</code>.</p></li></ul><p><strong>Dialect Specific Options</strong></p><ul><li><code>legalize_chlo_to_stablehlo</code>: If <code>true</code>, <code>chlo</code> dialect ops will be converted to <code>stablehlo</code> ops. (Default: <code>false</code>).</li></ul><p><strong>Backend Specific Options</strong></p><p><strong>Only for CUDA backend</strong></p><ul><li><code>cudnn_hlo_optimize</code>: Run cuDNN specific HLO optimizations. This is only relevant for GPU backends and is <code>false</code> by default. <strong>Experimental and not heavily tested.</strong></li></ul><p><strong>Sharding Options</strong></p><ul><li><p><code>shardy_passes</code>: Defaults to <code>:post_sdy_propagation</code>. Other options are:</p><ul><li><p><code>:none</code>: No sharding passes will be run. Shardy + MHLO shardings are handled by XLA.</p></li><li><p><code>:post_sdy_propagation</code>: Runs the Shardy propagation passes. MHLO shardings are handled by XLA.</p></li><li><p><a href="/Reactant.jl/previews/PR2517/api/api#Reactant.ShardyPropagationOptions"><code>ShardyPropagationOptions</code></a>: Custom sharding propagation options. MHLO shardings are handled by XLA.</p></li><li><p><code>:to_mhlo_shardings</code>: Runs the Shardy propagation passes and then exports the shardings to MHLO. All passes are run via MLIR pass pipeline and don&#39;t involve XLA.</p></li></ul></li><li><p><code>optimize_then_pad</code>: If <code>true</code>, the function will be optimized before padding (for non-divisible sharding axes) is applied. Defaults to <code>true</code>. <em>(Only for Sharded Inputs)</em></p></li><li><p><code>optimize_communications</code>: If <code>true</code>, additional passes for optimizing communication in sharded computations will be run. Defaults to <code>true</code>. <em>(Only for Sharded Inputs)</em></p></li></ul><p><strong>Julia Codegen Options</strong></p><ul><li><p><code>donated_args</code>: If <code>:auto</code>, the function will automatically donate the arguments that are not preserved in the function body. If <code>:none</code>, no arguments will be donated. Defaults to <code>:auto</code>.</p></li><li><p><code>assert_nonallocating</code>: If <code>true</code>, we make sure that no new buffers are returned by the function. Any buffer returned must be donated from the inputs. Defaults to <code>false</code>.</p></li><li><p><code>sync</code>: Reactant computations are asynchronous by default. If <code>true</code>, the computation will be executed synchronously, blocking till the computation is complete. This is recommended when benchmarking.</p></li></ul><p><strong>Extended Help</strong></p><p><strong>Internal XLA Options</strong></p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>We have limited control over these options (in terms of semantic versioning) since they are tied to XLA upstream.</p></div><ul><li><p><code>xla_executable_build_options</code>: XLA executable build options. Additional options that are passed to ExecutableBuildOptionsProto.</p></li><li><p><code>xla_compile_options</code>: XLA compile options. Additional options that are passed to CompileOptionsProto.</p></li><li><p><code>xla_debug_options</code>: XLA debug options. Additional options that are passed to DebugOptionsProto.</p></li></ul><p><strong>Private Options</strong></p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>These options are not part of the public API and are subject to change without any notice or deprecation cycle.</p></div><ul><li><p><code>disable_scatter_gather_optimization_passes</code>: Disables the scatter-gather optimization passes. (Default: <code>false</code>).</p></li><li><p><code>disable_pad_optimization_passes</code>: Disables the pad optimization passes. This is <code>false</code> by default.</p></li><li><p><code>disable_licm_optimization_passes</code>: Disables the Loop Invariant Code Motion (LICM) optimization passes. (Default: <code>false</code>).</p></li><li><p><code>disable_reduce_slice_fusion_passes</code>: Disables fusion of slice elementwise and reduce operations. (Default <code>false</code>).</p></li><li><p><code>disable_slice_to_batch_passes</code>: Disables the slice to batch fusion optimization passes. (Default: <code>true</code>). <em>(Note that this is generally an expensive pass to run)</em></p></li><li><p><code>disable_concat_to_batch_passes</code>: Disables concatenate to batch fusion passes. (Default: <code>false</code>).</p></li><li><p><code>disable_loop_raising_passes</code>: Disables raising passes for <code>stablehlo.while</code>. (Default: <code>false</code>).</p></li><li><p><code>disable_structured_tensors_detection_passes</code>: Disables structured tensors detection passes. (Default <code>true</code>).</p></li><li><p><code>disable_structured_tensors_passes</code>: Disables structured tensors optimization passes. (Default <code>false</code>).</p></li></ul>',22)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[50]||(i[50]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/CompileOptions.jl#L72-L194",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",v,[s("summary",null,[i[52]||(i[52]=s("a",{id:"Reactant.DefaultXLACompileOptions",href:"#Reactant.DefaultXLACompileOptions"},[s("span",{class:"jlbinding"},"Reactant.DefaultXLACompileOptions")],-1)),i[53]||(i[53]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[55]||(i[55]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DefaultXLACompileOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    donated_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:auto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, sync</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, optimize_then_pad</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, assert_nonallocating</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Runs specific Enzyme-JAX passes to ensure that the generated code is compatible with XLA compilation. For the documentation of the allowed kwargs see <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a>.</p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>This is mostly a benchmarking option, and the default <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.CompileOptions"><code>CompileOptions</code></a> is almost certainly a better option.</p></div>`,3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[54]||(i[54]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/CompileOptions.jl#L422-L434",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[146]||(i[146]=s("h3",{id:"Sharding-Specific-Options",tabindex:"-1"},[t("Sharding Specific Options "),s("a",{class:"header-anchor",href:"#Sharding-Specific-Options","aria-label":'Permalink to "Sharding Specific Options {#Sharding-Specific-Options}"'},"​")],-1)),s("details",j,[s("summary",null,[i[56]||(i[56]=s("a",{id:"Reactant.OptimizeCommunicationOptions",href:"#Reactant.OptimizeCommunicationOptions"},[s("span",{class:"jlbinding"},"Reactant.OptimizeCommunicationOptions")],-1)),i[57]||(i[57]=t()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),i[59]||(i[59]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OptimizeCommunicationOptions</span></span></code></pre></div><p>Fine-grained control over the optimization passes that rewrite ops to minimize collective communication.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[58]||(i[58]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/CompileOptions.jl#L2-L7",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",R,[s("summary",null,[i[60]||(i[60]=s("a",{id:"Reactant.ShardyPropagationOptions",href:"#Reactant.ShardyPropagationOptions"},[s("span",{class:"jlbinding"},"Reactant.ShardyPropagationOptions")],-1)),i[61]||(i[61]=t()),e(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),i[63]||(i[63]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ShardyPropagationOptions</span></span></code></pre></div><p>Fine-grained control over the sharding propagation pipeline. For more information on sharding propagation, see the <a href="https://openxla.org/shardy/sdy_propagation_passes" target="_blank" rel="noreferrer">Shardy Docs</a>.</p><p><strong>Options</strong></p><ul><li><p><code>keep_sharding_rules::Bool</code>: whether to keep existing and created op sharding rules.</p></li><li><p><code>conservative_propagation::Bool</code>: whether to disallow split axes and non-divisible sharding axes during propagation.</p></li><li><p><code>debug_sharding_origins::Bool</code>: whether to save information about the origin of a sharding on the MLIR module. These would be the shardings on the function inputs, outputs, sharding constraints and manual computations before propagation.</p></li><li><p><code>debug_propagation_edge_sharding::Bool</code>: whether to save information about the edge source of a sharding on the MLIR module. These are what operand/result introduced a sharding on some op result.</p></li><li><p><code>skip_convert_to_reshard::Bool</code></p></li><li><p><code>skip_inline::Bool</code></p></li><li><p><code>enable_insert_explicit_collectives::Bool</code>: whether to insert explicit collectives for sharding propagation. This is useful for debugging and checking the location of the communication ops.</p></li></ul>',4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[62]||(i[62]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/CompileOptions.jl#L38-L61",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[147]||(i[147]=s("h2",{id:"Tracing-customization",tabindex:"-1"},[t("Tracing customization "),s("a",{class:"header-anchor",href:"#Tracing-customization","aria-label":'Permalink to "Tracing customization {#Tracing-customization}"'},"​")],-1)),s("details",D,[s("summary",null,[i[64]||(i[64]=s("a",{id:"Reactant.@skip_rewrite_func",href:"#Reactant.@skip_rewrite_func"},[s("span",{class:"jlbinding"},"Reactant.@skip_rewrite_func")],-1)),i[65]||(i[65]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[67]||(i[67]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@skip_rewrite_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f</span></span></code></pre></div><p>Mark function <code>f</code> so that Reactant&#39;s IR rewrite mechanism will skip it. This can improve compilation time if it&#39;s safe to assume that no call inside <code>f</code> will need a <code>@reactant_overlay</code> method.</p><div class="tip custom-block"><p class="custom-block-title">Info</p><p>Note that this marks the whole function, not a specific method with a type signature.</p></div><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The macro call should be inside the <code>__init__</code> function. If you want to mark it for precompilation, you must add the macro call in the global scope too.</p></div><p>See also: <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.@skip_rewrite_type"><code>@skip_rewrite_type</code></a></p>',5)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[66]||(i[66]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/utils.jl#L206-L223",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",T,[s("summary",null,[i[68]||(i[68]=s("a",{id:"Reactant.@skip_rewrite_type",href:"#Reactant.@skip_rewrite_type"},[s("span",{class:"jlbinding"},"Reactant.@skip_rewrite_type")],-1)),i[69]||(i[69]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[71]||(i[71]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@skip_rewrite_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MyStruct</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@skip_rewrite_type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Type{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MyStruct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Mark the construct function of <code>MyStruct</code> so that Reactant&#39;s IR rewrite mechanism will skip it. It does the same as <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.@skip_rewrite_func"><code>@skip_rewrite_func</code></a> but for type constructors.</p><p>If you want to mark the set of constructors over it&#39;s type parameters or over its abstract type, you should use then the <code>Type{&lt;:MyStruct}</code> syntax.</p><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>The macro call should be inside the <code>__init__</code> function. If you want to mark it for precompilation, you must add the macro call in the global scope too.</p></div>`,4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[70]||(i[70]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/utils.jl#L255-L270",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[148]||(i[148]=s("h2",{id:"Profile-XLA",tabindex:"-1"},[t("Profile XLA "),s("a",{class:"header-anchor",href:"#Profile-XLA","aria-label":'Permalink to "Profile XLA {#Profile-XLA}"'},"​")],-1)),i[149]||(i[149]=s("p",null,[t("Reactant can hook into XLA's profiler to generate compilation and execution traces. See the "),s("a",{href:"/Reactant.jl/previews/PR2517/tutorials/profiling#profiling"},"profiling tutorial"),t(" for more details.")],-1)),s("details",x,[s("summary",null,[i[72]||(i[72]=s("a",{id:"Reactant.Profiler.with_profiler",href:"#Reactant.Profiler.with_profiler"},[s("span",{class:"jlbinding"},"Reactant.Profiler.with_profiler")],-1)),i[73]||(i[73]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[75]||(i[75]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with_profiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, trace_output_dir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; trace_device</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, trace_host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, create_perfetto_link</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Runs the provided function under a profiler for XLA (similar to <a href="https://jax.readthedocs.io/en/latest/profiling.html" target="_blank" rel="noreferrer">JAX&#39;s profiler</a>). The traces will be exported in the provided folder and can be seen using tools like <a href="https://ui.perfetto.dev" target="_blank" rel="noreferrer">perfetto.dev</a>. It will return the return values from the function. The <code>create_perfetto_link</code> parameter can be used to automatically generate a perfetto url to visualize the trace.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">compiled_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> with_profiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./traces&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    @compile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sync</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> myfunc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, y, z)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">with_profiler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./traces/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    compiled_func</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, y, z)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>When profiling compiled functions make sure to <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Compiler.@compile"><code>Reactant.Compiler.@compile</code></a> with the <code>sync=true</code> option so that the compiled execution is captured by the profiler.</p></div>`,4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[74]||(i[74]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L11-L33",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",P,[s("summary",null,[i[76]||(i[76]=s("a",{id:"Reactant.Profiler.annotate",href:"#Reactant.Profiler.annotate"},[s("span",{class:"jlbinding"},"Reactant.Profiler.annotate")],-1)),i[77]||(i[77]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[79]||(i[79]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">annotate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(f, name, [level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TRACE_ME_LEVEL_CRITICAL]; [metadata])</span></span></code></pre></div><p>Generate an annotation in the current trace. Optionally include metadata as key-value pairs.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">annotate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my_operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ... do work ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">annotate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my_operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key1&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;value1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key2&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ... do work ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div>`,4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[78]||(i[78]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L133-L148",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",w,[s("summary",null,[i[80]||(i[80]=s("a",{id:"Reactant.Profiler.@annotate",href:"#Reactant.Profiler.@annotate"},[s("span",{class:"jlbinding"},"Reactant.Profiler.@annotate")],-1)),i[81]||(i[81]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[83]||(i[83]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@annotate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [name] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> foo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(a, b, c)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>The created function will generate an annotation in the captured XLA profiles.</p>`,2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[82]||(i[82]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L163-L169",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",B,[s("summary",null,[i[84]||(i[84]=s("a",{id:"Reactant.Profiler.@time",href:"#Reactant.Profiler.@time"},[s("span",{class:"jlbinding"},"Reactant.Profiler.@time")],-1)),i[85]||(i[85]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[87]||(i[87]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [nrepeat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [warmup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [compile_options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Profiles the given function and prints the runtime and compile time. <code>fn</code> will be compiled with <code>compile_options</code> if it is not already a reactant compiled function.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[86]||(i[86]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L863-L869",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",I,[s("summary",null,[i[88]||(i[88]=s("a",{id:"Reactant.Profiler.@timed",href:"#Reactant.Profiler.@timed"},[s("span",{class:"jlbinding"},"Reactant.Profiler.@timed")],-1)),i[89]||(i[89]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[91]||(i[91]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@timed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [nrepeat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [warmup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [compile_options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Profiles the given function and returns the runtime, compile time, and memory data. <code>fn</code> will be compiled with <code>compile_options</code> if it is not already a reactant compiled function.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[90]||(i[90]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L837-L843",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",S,[s("summary",null,[i[92]||(i[92]=s("a",{id:"Reactant.Profiler.@profile",href:"#Reactant.Profiler.@profile"},[s("span",{class:"jlbinding"},"Reactant.Profiler.@profile")],-1)),i[93]||(i[93]=t()),e(a,{type:"info",class:"jlObjectType jlMacro",text:"Macro"})]),i[95]||(i[95]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [nrepeat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [warmup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] [compile_options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Profiles the given function and prints detailed kernel and framework op statistics. <code>fn</code> will be compiled with <code>compile_options</code> if it is not already a reactant compiled function.</p><p>Returns the result of the function call.</p>',3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[94]||(i[94]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L1259-L1267",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",O,[s("summary",null,[i[96]||(i[96]=s("a",{id:"Reactant.Profiler.profiler_activity_start",href:"#Reactant.Profiler.profiler_activity_start"},[s("span",{class:"jlbinding"},"Reactant.Profiler.profiler_activity_start")],-1)),i[97]||(i[97]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[99]||(i[99]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">profiler_activity_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Cint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[, metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dict{String, &lt;:Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">profiler_activity_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, level</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Cint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[, metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Pair{String, &lt;:Any}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">...])</span></span></code></pre></div><p>Start a profiler activity with metadata (key-value pairs). The metadata will be encoded into the trace event and can be viewed in profiling tools like Perfetto.</p><p>Returns an activity ID that should be passed to <code>profiler_activity_end</code> when the activity ends.</p><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> profiler_activity_start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;my_operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, TRACE_ME_LEVEL_INFO,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                             &quot;key1&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;value1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;key2&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ... do work ...</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">profiler_activity_end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id)</span></span></code></pre></div>`,5)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[98]||(i[98]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L89-L105",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",L,[s("summary",null,[i[100]||(i[100]=s("a",{id:"Reactant.Profiler.profiler_activity_end",href:"#Reactant.Profiler.profiler_activity_end"},[s("span",{class:"jlbinding"},"Reactant.Profiler.profiler_activity_end")],-1)),i[101]||(i[101]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[103]||(i[103]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">profiler_activity_end</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>End a profiler activity. See <a href="/Reactant.jl/previews/PR2517/api/api#Reactant.Profiler.profiler_activity_start"><code>profiler_activity_start</code></a> for more information.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[102]||(i[102]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L124-L128",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[150]||(i[150]=s("h3",{id:"XProf-APIs",tabindex:"-1"},[t("XProf APIs "),s("a",{class:"header-anchor",href:"#XProf-APIs","aria-label":'Permalink to "XProf APIs {#XProf-APIs}"'},"​")],-1)),s("details",z,[s("summary",null,[i[104]||(i[104]=s("a",{id:"Reactant.Profiler.initialize_xprof_stubs",href:"#Reactant.Profiler.initialize_xprof_stubs"},[s("span",{class:"jlbinding"},"Reactant.Profiler.initialize_xprof_stubs")],-1)),i[105]||(i[105]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[107]||(i[107]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">initialize_xprof_stubs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(worker_service_address</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Initialize XProf stubs for remote profiling. This sets up the worker service address for connecting to the XProf profiler service.</p><p><strong>Arguments</strong></p><ul><li><code>worker_service_address</code>: The address of the worker service (e.g., &quot;localhost:9001&quot;)</li></ul>',4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[106]||(i[106]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L273-L282",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",N,[s("summary",null,[i[108]||(i[108]=s("a",{id:"Reactant.Profiler.start_xprof_grpc_server",href:"#Reactant.Profiler.start_xprof_grpc_server"},[s("span",{class:"jlbinding"},"Reactant.Profiler.start_xprof_grpc_server")],-1)),i[109]||(i[109]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[111]||(i[111]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">start_xprof_grpc_server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Integer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Start an XProf GRPC server on the specified port. This allows remote profiling connections from tools like TensorBoard.</p><p><strong>Arguments</strong></p><ul><li><code>port</code>: The port number to start the GRPC server on</li></ul>',4)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[110]||(i[110]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L290-L299",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",V,[s("summary",null,[i[112]||(i[112]=s("a",{id:"Reactant.Profiler.xspace_to_tools_data",href:"#Reactant.Profiler.xspace_to_tools_data"},[s("span",{class:"jlbinding"},"Reactant.Profiler.xspace_to_tools_data")],-1)),i[113]||(i[113]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[115]||(i[115]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">xspace_to_tools_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    xspace_paths</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Vector{String}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tool_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dict</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Convert XSpace profile data to a specific tool format.</p><p><strong>Arguments</strong></p><ul><li><p><code>xspace_paths</code>: Vector of paths to XSpace profile directories</p></li><li><p><code>tool_name</code>: Name of the tool to convert to (e.g., &quot;trace_viewer&quot;, &quot;tensorflow_stats&quot;, &quot;overview_page&quot;)</p></li><li><p><code>options</code>: Optional dictionary of tool-specific options. Values can be Bool, Int, or String.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Vector{UInt8}, Bool}</code>: A tuple of (data, is_binary) where data is the converted profile data and is_binary indicates whether the data is in binary format.</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data, is_binary </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> xspace_to_tools_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/path/to/xspace&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;trace_viewer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,8)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[114]||(i[114]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Profiler.jl#L305-L330",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[151]||(i[151]=s("h2",{id:"Devices",tabindex:"-1"},[t("Devices "),s("a",{class:"header-anchor",href:"#Devices","aria-label":'Permalink to "Devices {#Devices}"'},"​")],-1)),s("details",X,[s("summary",null,[i[116]||(i[116]=s("a",{id:"Reactant.devices",href:"#Reactant.devices"},[s("span",{class:"jlbinding"},"Reactant.devices")],-1)),i[117]||(i[117]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[119]||(i[119]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">devices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">devices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">XLA.AbstractClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XLA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p>Return a list of devices available for the given client.</p>`,2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[118]||(i[118]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Devices.jl#L1-L6",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",M,[s("summary",null,[i[120]||(i[120]=s("a",{id:"Reactant.addressable_devices",href:"#Reactant.addressable_devices"},[s("span",{class:"jlbinding"},"Reactant.addressable_devices")],-1)),i[121]||(i[121]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[123]||(i[123]=n(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">addressable_devices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">addressable_devices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(backend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">XLA.AbstractClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XLA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_backend</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p>Return a list of addressable devices available for the given client.</p>`,2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[122]||(i[122]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Devices.jl#L11-L16",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[152]||(i[152]=s("h2",{id:"Differentiation-Specific-API",tabindex:"-1"},[t("Differentiation Specific API "),s("a",{class:"header-anchor",href:"#Differentiation-Specific-API","aria-label":'Permalink to "Differentiation Specific API {#Differentiation-Specific-API}"'},"​")],-1)),s("details",q,[s("summary",null,[i[124]||(i[124]=s("a",{id:"EnzymeCore.ignore_derivatives",href:"#EnzymeCore.ignore_derivatives"},[s("span",{class:"jlbinding"},"EnzymeCore.ignore_derivatives")],-1)),i[125]||(i[125]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[127]||(i[127]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ignore_derivatives</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T</span></span></code></pre></div><p>Behaves like the <code>identity</code> function, but disconnects the &quot;shadow&quot; associated with <code>x</code>. This has the effect of preventing any derivatives from being propagated through <code>x</code>.</p><div class="tip custom-block"><p class="custom-block-title">Enzyme 0.13.74</p><p>Support for <code>ignore_derivatives</code> was added in Enzyme 0.13.74.</p></div>',3)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[126]||(i[126]=[s("a",{href:"https://github.com/EnzymeAD/Enzyme.jl/blob/v0.8.18/src/EnzymeCore.jl#L623-L632",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[153]||(i[153]=s("h2",{id:"Persistent-Compilation-Cache",tabindex:"-1"},[t("Persistent Compilation Cache "),s("a",{class:"header-anchor",href:"#Persistent-Compilation-Cache","aria-label":'Permalink to "Persistent Compilation Cache {#Persistent-Compilation-Cache}"'},"​")],-1)),s("details",H,[s("summary",null,[i[128]||(i[128]=s("a",{id:"Reactant.PersistentCompileCache.clear_compilation_cache!",href:"#Reactant.PersistentCompileCache.clear_compilation_cache!"},[s("span",{class:"jlbinding"},"Reactant.PersistentCompileCache.clear_compilation_cache!")],-1)),i[129]||(i[129]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[131]||(i[131]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">clear_compilation_cache!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>Deletes the compilation cache directory. This removes all cached compilation artifacts for all past versions of Reactant_jll.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[130]||(i[130]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/PersistentCompileCache.jl#L66-L71",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i[154]||(i[154]=s("h2",{id:"Internal-utils",tabindex:"-1"},[t("Internal utils "),s("a",{class:"header-anchor",href:"#Internal-utils","aria-label":'Permalink to "Internal utils {#Internal-utils}"'},"​")],-1)),s("details",U,[s("summary",null,[i[132]||(i[132]=s("a",{id:"ReactantCore.materialize_traced_array",href:"#ReactantCore.materialize_traced_array"},[s("span",{class:"jlbinding"},"ReactantCore.materialize_traced_array")],-1)),i[133]||(i[133]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[135]||(i[135]=n('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">materialize_traced_array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(AbstractArray{</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TracedRNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TracedRArray</span></span></code></pre></div><p>Given an AbstractArray{TracedRNumber}, return or create an equivalent TracedRArray.</p>',2)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[134]||(i[134]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/lib/ReactantCore/src/ReactantCore.jl#L729-L734",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s("details",G,[s("summary",null,[i[136]||(i[136]=s("a",{id:"Reactant.apply_type_with_promotion",href:"#Reactant.apply_type_with_promotion"},[s("span",{class:"jlbinding"},"Reactant.apply_type_with_promotion")],-1)),i[137]||(i[137]=t()),e(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),i[139]||(i[139]=n(`<p>This function tries to apply the param types to the wrapper type. When there&#39;s a constraint conflict, it tries to resolve it:</p><ul><li><p>ConcreteRNumber{T} vs T: resolves to T</p></li><li><p>other cases: resolve by <code>promote_type</code></p></li></ul><p>The new param type is then propagated in any param type that depends on it. Apart from the applied type, it also returns a boolean array indicating which of the param types were changed.</p><p>For example:</p><div class="language-jl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jl</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Reactant</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Foo{T, A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray{T}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">A</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">apply_type_with_promotion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Foo, (Int, TracedRArray{Int, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}))</span></span></code></pre></div><p>returns</p><div class="language-jl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jl</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Foo{Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TracedRNumber{Int64}, Reactant</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TracedRArray{Int64, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}}, Bool[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><p>The first type parameter has been promoted to satisfy to be in agreement with the second parameter.</p>`,8)),e(a,{type:"info",class:"source-link",text:"source"},{default:l(()=>[...i[138]||(i[138]=[s("a",{href:"https://github.com/EnzymeAD/Reactant.jl/blob/4f4aef627fac601b44a8415e26f18bfb7072f895/src/Tracing.jl#L920-L942",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const si=p(d,[["render",J]]);export{ii as __pageData,si as default};
